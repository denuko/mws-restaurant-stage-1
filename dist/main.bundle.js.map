{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/idb/lib/idb.js","webpack:///./src/js/dbhelper.js","webpack:///./src/js/helper.js","webpack:///./node_modules/style-loader/lib/urls.js","webpack:///./node_modules/style-loader/lib/addStyles.js","webpack:///./src/css/styles.css","webpack:///./src/js/main.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","default","object","property","prototype","hasOwnProperty","p","s","e","promisifyRequest","request","Promise","resolve","reject","onsuccess","result","onerror","error","promisifyRequestCall","obj","method","args","apply","then","proxyProperties","ProxyClass","targetProp","properties","forEach","prop","this","set","val","proxyRequestMethods","Constructor","arguments","proxyMethods","proxyCursorRequestMethods","Cursor","Index","index","_index","cursor","_cursor","_request","ObjectStore","store","_store","Transaction","idbTransaction","_tx","complete","oncomplete","onabort","UpgradeDB","db","oldVersion","transaction","_db","DB","IDBIndex","IDBCursor","methodName","createIndex","IDBObjectStore","objectStore","IDBTransaction","createObjectStore","IDBDatabase","funcName","replace","arr","Array","slice","callback","length","nativeObject","getAll","query","count","instance","items","iterateCursor","push","continue","exp","open","version","upgradeCallback","indexedDB","onupgradeneeded","event","delete","configurable","writable","DBHelper","addRestaurants","navigator","serviceWorker","idb","upgradeDb","keyPath","autoIncrement","fetch","DATABASE_URL","response","json","restaurants","catch","id","getRestaurantFromDbById","restaurant","is_favorite","addRestaurantToDatabase","status","DATABASE_PROMISE","Number","msg","console","log","cuisine","fetchRestaurants","results","filter","cuisine_type","neighborhood","tx","viewRestaurants","neighborhoods","map","v","uniqueNeighborhoods","indexOf","cuisines","uniqueCuisines","photograph","google","maps","Marker","position","latlng","title","url","urlForRestaurant","animation","Animation","DROP","put","restaurant_id","reviews","sort","a","b","createdAt","DATABASE_URL_REVIEWS","review","postReviewToServer","addReviewToDatabase","controller","postMessage","action","getLastReviewId","id_local","body","JSON","stringify","addedReview","openCursor","openDatabase","addImageSourceToPicture","picture","srcset","media","source","document","createElement","setAttribute","append","fileExtension","filename","split","pop","filenameWithoutExtension","imageNamesBySize","imageFilename","filenames","small","medium","large","getGoogleMapsApi","getElementById","IntersectionObserver","entries","observer","isIntersecting","intersectionRatio","className","mapOffline","mapOfflineMessage","innerHTML","appendChild","loadjs","unobserve","rootMargin","threshold","observe","getLazyLoadPlugin","w","getElementsByTagName","async","src","lazyLoadOptions","elements_selector","window","timestampToDate","timestamp","date","Date","day","getDate","getMonthName","getMonth","getFullYear","monthIndex","month","css","location","Error","baseUrl","protocol","host","currentDir","pathname","fullMatch","origUrl","newUrl","unquotedOrigUrl","trim","$1","test","stylesInDom","isOldIE","fn","memo","all","atob","getElement","target","styleTarget","querySelector","HTMLIFrameElement","contentDocument","head","singleton","singletonCounter","stylesInsertedAtTop","fixUrls","addStylesToDom","styles","options","item","domStyle","refs","j","parts","addStyle","listToStyles","list","newStyles","base","part","sourceMap","insertStyleElement","style","insertInto","lastStyleElementInsertedAtTop","insertAt","nextSibling","insertBefore","firstChild","before","removeStyleElement","parentNode","removeChild","idx","splice","createStyleElement","attrs","type","addAttrs","el","keys","update","remove","transform","styleIndex","applyToSingletonTag","URL","createObjectURL","revokeObjectURL","Blob","btoa","link","rel","autoFixUrls","convertToAbsoluteUrls","unescape","encodeURIComponent","blob","oldSrc","href","styleSheet","cssText","createTextNode","newObj","DEBUG","newList","mayRemove","replaceText","textStore","replacement","Boolean","join","cssNode","childNodes","content","hmr","locals","_helper","addEventListener","updateRestaurants","initMap","self","Map","zoom","center","lat","lng","scrollwheel","addMarkersToMap","cSelect","nSelect","cIndex","selectedIndex","nIndex","fetchRestaurantByCuisineAndNeighborhood","resetRestaurants","fillRestaurantsHTML","markers","setMap","ul","createRestaurantHTML","includes","select","option","li","image","alt","imageUrlForRestaurant","noImgFallback","imagesResized","more","tabIndex","address","marker","mapMarkerForRestaurant","addListener"],"mappings":"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","file":"main.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 11);\n","'use strict';\n\n(function() {\n  function toArray(arr) {\n    return Array.prototype.slice.call(arr);\n  }\n\n  function promisifyRequest(request) {\n    return new Promise(function(resolve, reject) {\n      request.onsuccess = function() {\n        resolve(request.result);\n      };\n\n      request.onerror = function() {\n        reject(request.error);\n      };\n    });\n  }\n\n  function promisifyRequestCall(obj, method, args) {\n    var request;\n    var p = new Promise(function(resolve, reject) {\n      request = obj[method].apply(obj, args);\n      promisifyRequest(request).then(resolve, reject);\n    });\n\n    p.request = request;\n    return p;\n  }\n\n  function promisifyCursorRequestCall(obj, method, args) {\n    var p = promisifyRequestCall(obj, method, args);\n    return p.then(function(value) {\n      if (!value) return;\n      return new Cursor(value, p.request);\n    });\n  }\n\n  function proxyProperties(ProxyClass, targetProp, properties) {\n    properties.forEach(function(prop) {\n      Object.defineProperty(ProxyClass.prototype, prop, {\n        get: function() {\n          return this[targetProp][prop];\n        },\n        set: function(val) {\n          this[targetProp][prop] = val;\n        }\n      });\n    });\n  }\n\n  function proxyRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function proxyMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return this[targetProp][prop].apply(this[targetProp], arguments);\n      };\n    });\n  }\n\n  function proxyCursorRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyCursorRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function Index(index) {\n    this._index = index;\n  }\n\n  proxyProperties(Index, '_index', [\n    'name',\n    'keyPath',\n    'multiEntry',\n    'unique'\n  ]);\n\n  proxyRequestMethods(Index, '_index', IDBIndex, [\n    'get',\n    'getKey',\n    'getAll',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(Index, '_index', IDBIndex, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  function Cursor(cursor, request) {\n    this._cursor = cursor;\n    this._request = request;\n  }\n\n  proxyProperties(Cursor, '_cursor', [\n    'direction',\n    'key',\n    'primaryKey',\n    'value'\n  ]);\n\n  proxyRequestMethods(Cursor, '_cursor', IDBCursor, [\n    'update',\n    'delete'\n  ]);\n\n  // proxy 'next' methods\n  ['advance', 'continue', 'continuePrimaryKey'].forEach(function(methodName) {\n    if (!(methodName in IDBCursor.prototype)) return;\n    Cursor.prototype[methodName] = function() {\n      var cursor = this;\n      var args = arguments;\n      return Promise.resolve().then(function() {\n        cursor._cursor[methodName].apply(cursor._cursor, args);\n        return promisifyRequest(cursor._request).then(function(value) {\n          if (!value) return;\n          return new Cursor(value, cursor._request);\n        });\n      });\n    };\n  });\n\n  function ObjectStore(store) {\n    this._store = store;\n  }\n\n  ObjectStore.prototype.createIndex = function() {\n    return new Index(this._store.createIndex.apply(this._store, arguments));\n  };\n\n  ObjectStore.prototype.index = function() {\n    return new Index(this._store.index.apply(this._store, arguments));\n  };\n\n  proxyProperties(ObjectStore, '_store', [\n    'name',\n    'keyPath',\n    'indexNames',\n    'autoIncrement'\n  ]);\n\n  proxyRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'put',\n    'add',\n    'delete',\n    'clear',\n    'get',\n    'getAll',\n    'getKey',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  proxyMethods(ObjectStore, '_store', IDBObjectStore, [\n    'deleteIndex'\n  ]);\n\n  function Transaction(idbTransaction) {\n    this._tx = idbTransaction;\n    this.complete = new Promise(function(resolve, reject) {\n      idbTransaction.oncomplete = function() {\n        resolve();\n      };\n      idbTransaction.onerror = function() {\n        reject(idbTransaction.error);\n      };\n      idbTransaction.onabort = function() {\n        reject(idbTransaction.error);\n      };\n    });\n  }\n\n  Transaction.prototype.objectStore = function() {\n    return new ObjectStore(this._tx.objectStore.apply(this._tx, arguments));\n  };\n\n  proxyProperties(Transaction, '_tx', [\n    'objectStoreNames',\n    'mode'\n  ]);\n\n  proxyMethods(Transaction, '_tx', IDBTransaction, [\n    'abort'\n  ]);\n\n  function UpgradeDB(db, oldVersion, transaction) {\n    this._db = db;\n    this.oldVersion = oldVersion;\n    this.transaction = new Transaction(transaction);\n  }\n\n  UpgradeDB.prototype.createObjectStore = function() {\n    return new ObjectStore(this._db.createObjectStore.apply(this._db, arguments));\n  };\n\n  proxyProperties(UpgradeDB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(UpgradeDB, '_db', IDBDatabase, [\n    'deleteObjectStore',\n    'close'\n  ]);\n\n  function DB(db) {\n    this._db = db;\n  }\n\n  DB.prototype.transaction = function() {\n    return new Transaction(this._db.transaction.apply(this._db, arguments));\n  };\n\n  proxyProperties(DB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(DB, '_db', IDBDatabase, [\n    'close'\n  ]);\n\n  // Add cursor iterators\n  // TODO: remove this once browsers do the right thing with promises\n  ['openCursor', 'openKeyCursor'].forEach(function(funcName) {\n    [ObjectStore, Index].forEach(function(Constructor) {\n      // Don't create iterateKeyCursor if openKeyCursor doesn't exist.\n      if (!(funcName in Constructor.prototype)) return;\n\n      Constructor.prototype[funcName.replace('open', 'iterate')] = function() {\n        var args = toArray(arguments);\n        var callback = args[args.length - 1];\n        var nativeObject = this._store || this._index;\n        var request = nativeObject[funcName].apply(nativeObject, args.slice(0, -1));\n        request.onsuccess = function() {\n          callback(request.result);\n        };\n      };\n    });\n  });\n\n  // polyfill getAll\n  [Index, ObjectStore].forEach(function(Constructor) {\n    if (Constructor.prototype.getAll) return;\n    Constructor.prototype.getAll = function(query, count) {\n      var instance = this;\n      var items = [];\n\n      return new Promise(function(resolve) {\n        instance.iterateCursor(query, function(cursor) {\n          if (!cursor) {\n            resolve(items);\n            return;\n          }\n          items.push(cursor.value);\n\n          if (count !== undefined && items.length == count) {\n            resolve(items);\n            return;\n          }\n          cursor.continue();\n        });\n      });\n    };\n  });\n\n  var exp = {\n    open: function(name, version, upgradeCallback) {\n      var p = promisifyRequestCall(indexedDB, 'open', [name, version]);\n      var request = p.request;\n\n      if (request) {\n        request.onupgradeneeded = function(event) {\n          if (upgradeCallback) {\n            upgradeCallback(new UpgradeDB(request.result, event.oldVersion, request.transaction));\n          }\n        };\n      }\n\n      return p.then(function(db) {\n        return new DB(db);\n      });\n    },\n    delete: function(name) {\n      return promisifyRequestCall(indexedDB, 'deleteDatabase', [name]);\n    }\n  };\n\n  if (typeof module !== 'undefined') {\n    module.exports = exp;\n    module.exports.default = module.exports;\n  }\n  else {\n    self.idb = exp;\n  }\n}());\n","import idb from 'idb';\r\n\r\n/**\r\n * Common database helper functions.\r\n */\r\nclass DBHelper {\r\n\r\n    /**\r\n     * Database Promise.\r\n     * Returns the constant defined after the DBHelper class \r\n     * with the opened database.\r\n     */\r\n    static get DATABASE_PROMISE() {\r\n        return DATABASE_PROMISE;\r\n    }\r\n\r\n    /**\r\n     * Database URL.\r\n     * Change this to restaurants.json file location on your server.\r\n     */\r\n    static get DATABASE_URL() {\r\n        const port = 1337; // Change this to your server port\r\n        return `http://localhost:${port}/restaurants`;\r\n    }\r\n\r\n    /**\r\n     * Database URL Reviews.\r\n     * URL for access to reviews entity.\r\n     */\r\n    static get DATABASE_URL_REVIEWS() {\r\n        const port = 1337; // Change this to your server port\r\n        return `http://localhost:${port}/reviews`;\r\n    }\r\n\r\n    /**\r\n     * Call the variable defined after the DBHelper class which is a bool\r\n     * that indicates whether to store a restaurant into database\r\n     * before adding its html.\r\n     */\r\n    static addRestaurants() {\r\n        return addRestaurants;\r\n    }\r\n\r\n    static openDatabase() {\r\n        // If the browser doesn't support service worker,\r\n        // we don't care about having a database\r\n        if (!navigator.serviceWorker) {\r\n            return Promise.resolve();\r\n        }\r\n\r\n        return  idb.open('restaurants-db', 2, upgradeDb => {\r\n            switch (upgradeDb.oldVersion) {\r\n                case 0:\r\n                    upgradeDb.createObjectStore('restaurants', {keyPath: 'id'});\r\n                    const restaurantsStore = upgradeDb.transaction.objectStore('restaurants');\r\n                    restaurantsStore.createIndex('id', 'id');\r\n                case 1:\r\n                    // Add an AI id_local attribute for reviews and use it as keypath instead of id, \r\n                    // to deal with newly created reviews that don't have an id.\r\n                    upgradeDb.createObjectStore('reviews', {keyPath: 'id_local', autoIncrement: true});\r\n                    const reviewsStore = upgradeDb.transaction.objectStore('reviews');\r\n                    reviewsStore.createIndex('restaurant_id', 'restaurant_id');\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Fetch all restaurants.\r\n     */\r\n    static fetchRestaurants(callback) {\r\n        fetch(DBHelper.DATABASE_URL)\r\n                .then(response => response.json())\r\n                .then(restaurants => callback(null, restaurants))\r\n                .catch(error => callback(error, null));\r\n    }\r\n\r\n    /**\r\n     * Favorite a restaurant by its ID.\r\n     * Return Promise to avoid callback functions as parameters.\r\n     */\r\n    static favoriteRestaurantById(id) {\r\n        return new Promise((resolve, reject) => {\r\n            // Search idb for restaurant\r\n            DBHelper.getRestaurantFromDbById(id).then(restaurant => {\r\n                if (restaurant) { // Got the restaurant\r\n                    // If restaurant found in idb, update record\r\n                    restaurant.is_favorite = true;\r\n                    DBHelper.addRestaurantToDatabase(restaurant);\r\n                }\r\n\r\n                // Update data in server that restaurant is favorite\r\n                fetch(`${DBHelper.DATABASE_URL}/${id}/?is_favorite=true`, {method: 'PUT'})\r\n                        .then(response => {\r\n                            if (response.status == 200) {\r\n                                resolve('Success! (Favorite restaurant)');\r\n                            } else {\r\n                                reject('Failed! (Favorite restaurant)');\r\n                            }\r\n                        })\r\n                        .catch(error => reject(error));\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Favorite a restaurant by its ID.\r\n     * Return Promise to avoid callback functions as parameters.\r\n     */\r\n    static unfavoriteRestaurantById(id) {\r\n        // Search idb for restaurant\r\n        return new Promise((resolve, reject) => {\r\n            DBHelper.getRestaurantFromDbById(id).then(restaurant => {\r\n                if (restaurant) { // Got the restaurant\r\n                    // If restaurant found in idb, update record\r\n                    restaurant.is_favorite = false;\r\n                    DBHelper.addRestaurantToDatabase(restaurant);\r\n                }\r\n\r\n                // Update data in server that restaurant is unfavorited\r\n                fetch(`${DBHelper.DATABASE_URL}/${id}/?is_favorite=false`, {method: 'PUT'})\r\n                        .then(response => {\r\n                            if (response.status == 200) {\r\n                                resolve('Success! (Favorite restaurant)');\r\n                            } else {\r\n                                reject('Failed! (Favorite restaurant)');\r\n                            }\r\n                        })\r\n                        .catch(error => reject(error));\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Search restaurant in db by its id.\r\n     * Return Promise to avoid callback functions as parameters for actions\r\n     * need to be done after restaurant is searched.\r\n     */\r\n    static getRestaurantFromDbById(id) {\r\n        return new Promise((resolve, reject) => {\r\n            DBHelper.DATABASE_PROMISE.then(db => {\r\n                const tx = db.transaction('restaurants');\r\n                return tx.objectStore('restaurants').get(Number(id));\r\n            }).then(restaurant => {\r\n                resolve(restaurant);\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Fetch a restaurant by its ID.\r\n     */\r\n    static fetchRestaurantById(id, callback) {\r\n        // Search restaurant in db by its id.\r\n        DBHelper.getRestaurantFromDbById(id).then(restaurant => {\r\n            if (restaurant) {\r\n                callback(null, restaurant);\r\n            } else {\r\n                // fetch restaurant by id using stage 3 server api GET endpoint.\r\n                fetch(`${DBHelper.DATABASE_URL}/${id}/`)\r\n                        .then(response => response.json())\r\n                        .then(restaurant => {\r\n                            if (restaurant) { // Got the restaurant\r\n                                callback(null, restaurant);\r\n                                DBHelper.addRestaurantToDatabase(restaurant);\r\n                            } else { // Restaurant does not exist in the database\r\n                                callback('Restaurant does not exist', null);\r\n                            }\r\n                        })\r\n                        .catch(error => callback(error, null));\r\n            }\r\n        }, (msg) => console.log(msg));\r\n    }\r\n\r\n    /**\r\n     * Fetch restaurants by a cuisine type with proper error handling.\r\n     */\r\n    static fetchRestaurantByCuisine(cuisine, callback) {\r\n        // Fetch all restaurants  with proper error handling\r\n        DBHelper.fetchRestaurants((error, restaurants) => {\r\n            if (error) {\r\n                callback(error, null);\r\n            } else {\r\n                // Filter restaurants to have only given cuisine type\r\n                const results = restaurants.filter(r => r.cuisine_type == cuisine);\r\n                callback(null, results);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Fetch restaurants by a neighborhood with proper error handling.\r\n     */\r\n    static fetchRestaurantByNeighborhood(neighborhood, callback) {\r\n        // Fetch all restaurants\r\n        DBHelper.fetchRestaurants((error, restaurants) => {\r\n            if (error) {\r\n                callback(error, null);\r\n            } else {\r\n                // Filter restaurants to have only given neighborhood\r\n                const results = restaurants.filter(r => r.neighborhood == neighborhood);\r\n                callback(null, results);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Fetch restaurants by a cuisine and a neighborhood with proper error handling.\r\n     */\r\n    static fetchRestaurantByCuisineAndNeighborhood(cuisine, neighborhood, callback) {\r\n        DBHelper.DATABASE_PROMISE.then(db => {\r\n            const tx = db.transaction('restaurants');\r\n            const restaurantsStore = tx.objectStore('restaurants');\r\n\r\n            return tx.objectStore('restaurants').getAll();\r\n        }).then(restaurants => {\r\n            if (!restaurants.length) {\r\n                addRestaurants = true;\r\n                // Fetch all restaurants\r\n                DBHelper.fetchRestaurants((error, restaurants) => {\r\n                    if (error) {\r\n                        callback(error, null);\r\n                    } else {\r\n                        DBHelper.viewRestaurants(restaurants, cuisine, neighborhood, callback);\r\n                        addRestaurants = false;\r\n                    }\r\n                });\r\n            } else {\r\n                console.log('Restaurants:', restaurants);\r\n                DBHelper.viewRestaurants(restaurants, cuisine, neighborhood, callback);\r\n            }\r\n        }).catch(error => callback(error, null));\r\n    }\r\n\r\n    static viewRestaurants(restaurants, cuisine, neighborhood, callback) {\r\n        let results = restaurants\r\n        if (cuisine != 'all') { // filter by cuisine\r\n            results = results.filter(r => r.cuisine_type == cuisine);\r\n        }\r\n        if (neighborhood != 'all') { // filter by neighborhood\r\n            results = results.filter(r => r.neighborhood == neighborhood);\r\n        }\r\n        callback(null, results);\r\n    }\r\n\r\n    /**\r\n     * Fetch all neighborhoods with proper error handling.\r\n     */\r\n    static fetchNeighborhoods(callback) {\r\n        // Fetch all restaurants\r\n        DBHelper.fetchRestaurants((error, restaurants) => {\r\n            if (error) {\r\n                callback(error, null);\r\n            } else {\r\n                // Get all neighborhoods from all restaurants\r\n                const neighborhoods = restaurants.map((v, i) => restaurants[i].neighborhood)\r\n                // Remove duplicates from neighborhoods\r\n                const uniqueNeighborhoods = neighborhoods.filter((v, i) => neighborhoods.indexOf(v) == i)\r\n                callback(null, uniqueNeighborhoods);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Fetch all cuisines with proper error handling.\r\n     */\r\n    static fetchCuisines(callback) {\r\n        // Fetch all restaurants\r\n        DBHelper.fetchRestaurants((error, restaurants) => {\r\n            if (error) {\r\n                callback(error, null);\r\n            } else {\r\n                // Get all cuisines from all restaurants\r\n                const cuisines = restaurants.map((v, i) => restaurants[i].cuisine_type)\r\n                // Remove duplicates from cuisines\r\n                const uniqueCuisines = cuisines.filter((v, i) => cuisines.indexOf(v) == i)\r\n                callback(null, uniqueCuisines);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Restaurant page URL.\r\n     */\r\n    static urlForRestaurant(restaurant) {\r\n        return (`./restaurant.html?id=${restaurant.id}`);\r\n    }\r\n\r\n    /**\r\n     * Restaurant image URL.\r\n     */\r\n    static imageUrlForRestaurant(restaurant) {\r\n        // Check if restaurant object has a photograph\r\n        if ('photograph' in restaurant) {\r\n            return (`/img/${restaurant.photograph}`);\r\n        } else {\r\n            // If restaurant has not a photograph return 'noimg' so that the\r\n            // rest of the code knows what to do\r\n            return 'noimg';\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Map marker for a restaurant.\r\n     */\r\n    static mapMarkerForRestaurant(restaurant, map) {\r\n        const marker = new google.maps.Marker({\r\n            position: restaurant.latlng,\r\n            title: restaurant.name,\r\n            url: DBHelper.urlForRestaurant(restaurant),\r\n            map: map,\r\n            animation: google.maps.Animation.DROP}\r\n        );\r\n        return marker;\r\n    }\r\n\r\n    /**\r\n     * Add restaurant to database.\r\n     */\r\n    static addRestaurantToDatabase(restaurant) {\r\n        DBHelper.DATABASE_PROMISE.then(function(db) {\r\n            var tx = db.transaction('restaurants', 'readwrite');\r\n            var restaurantsStore = tx.objectStore('restaurants');\r\n            restaurantsStore.put(restaurant);\r\n\r\n            return tx.complete;\r\n        }).then(function() {\r\n            console.log('Restaurant added');\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Fetch all review by restaurant id.\r\n     */\r\n    static fetchReviewsByRestaurantId(restaurant_id) {\r\n        return new Promise((resolve, reject) => {\r\n            // Check if restaurant's reviews exist in db\r\n            DBHelper.DATABASE_PROMISE.then(db => {\r\n                const tx = db.transaction('reviews');\r\n                const reviewsStore = tx.objectStore('reviews');\r\n                const restaurantIdIndex = reviewsStore.index('restaurant_id');\r\n                return restaurantIdIndex.getAll(restaurant_id);\r\n            }).then(reviews => {\r\n//                console.log(reviews);\r\n//                return\r\n                if (!reviews.length) {\r\n                    // If not found in db, fetch them fro server\r\n                    fetch(`${DBHelper.DATABASE_URL_REVIEWS}/?restaurant_id=${restaurant_id}`)\r\n                            .then(response => response.json())\r\n                            // Resolve reviews with a boolean flag that indicates to add reviews to db\r\n                            .then(reviews => {\r\n//                                return\r\n                                reviews.sort((a, b) => {\r\n                                    if (a.createdAt < b.createdAt) {\r\n                                        return 1;\r\n                                    }\r\n                                    if (a.createdAt > b.createdAt) {\r\n                                        return -1;\r\n                                    }\r\n\r\n                                    // createdAt must be equal\r\n                                    return 0;\r\n                                });\r\n                                \r\n                                resolve([reviews, true]);\r\n                            })\r\n                            .catch(error => reject(error));\r\n                } else {\r\n                    // Sort reviews by date created desc before displaying them\r\n                    reviews.sort((a, b) => {\r\n                        if (a.createdAt < b.createdAt) {\r\n                            return 1;\r\n                        }\r\n                        if (a.createdAt > b.createdAt) {\r\n                            return -1;\r\n                        }\r\n\r\n                        // createdAt must be equal\r\n                        return 0;\r\n                    });\r\n                    \r\n                    // If found in db, resolve reviews with a boolean flag that indicates to not add reviews to db\r\n                    resolve([reviews, false]);\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    static addReview(review) {\r\n        return new Promise((resolve, reject) => {\r\n            DBHelper.postReviewToServer(review).then(review => {\r\n                console.log('Review created in server');\r\n                resolve(review);\r\n            }, msg => {\r\n                console.log(msg);\r\n\r\n                // If post failed, just add it to idb\r\n                DBHelper.addReviewToDatabase(review).then(review => {\r\n                    if (navigator.serviceWorker) {\r\n                        navigator.serviceWorker.controller.postMessage({action: 'sync', review: review});\r\n                    }\r\n\r\n                    reject(review);\r\n                });\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Add review to database.\r\n     */\r\n    static addReviewToDatabase(review) {\r\n        return new Promise((resolve, reject) => {\r\n            DBHelper.DATABASE_PROMISE.then(db => {\r\n                const tx = db.transaction('reviews', 'readwrite');\r\n                const reviewsStore = tx.objectStore('reviews');\r\n                reviewsStore.put(review);\r\n\r\n                return tx.complete;\r\n            }).then(() => {\r\n                // Get keypath of the review we 've just added (last added review)\r\n                DBHelper.getLastReviewId().then(id_local => {\r\n                    console.log('Review added');\r\n\r\n                    // Assign keypath to review object for later use\r\n                    review.id_local = id_local;\r\n                    resolve(review);\r\n                }, msg => console.log(msg));\r\n            });\r\n        });\r\n    }\r\n\r\n    static postReviewToServer(review) {\r\n        return new Promise((resolve, reject) => {\r\n            fetch('http://localhost:1337/reviews/', {\r\n                method: 'POST',\r\n                body: JSON.stringify(review)\r\n            }).then(response => {\r\n                return response.json();\r\n            }).then(addedReview => {\r\n                if (addedReview) {\r\n                    review.id = addedReview.id;\r\n                    DBHelper.addReviewToDatabase(review);\r\n\r\n                    console.log('Review stored in server');\r\n                    resolve(review);\r\n                } else {\r\n                    reject('An error occured while saving in server');\r\n                }\r\n            }).catch(error => {\r\n                reject(error);\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Get keypath (id_local) of last added review.\r\n     */\r\n    static getLastReviewId() {\r\n        return new Promise((resolve, reject) => {\r\n            DBHelper.DATABASE_PROMISE.then(db => {\r\n                var tx = db.transaction('reviews');\r\n                var reviewsStore = tx.objectStore('reviews');\r\n\r\n                return reviewsStore.openCursor(null, 'prev');\r\n            }).then(cursor => {\r\n                if (!cursor) {\r\n                    reject('Last id not found');\r\n                    return;\r\n                }\r\n\r\n                return cursor.value.id_local;\r\n            }).then(id_local => {\r\n                resolve(id_local);\r\n                console.log('Done cursoring');\r\n            });\r\n        });\r\n    }\r\n}\r\n\r\nconst DATABASE_PROMISE = DBHelper.openDatabase();\r\nlet addRestaurants = false;\r\n\r\nexport default DBHelper;","/**\r\n * helper.js contains functions that help not repeat code\r\n * in order to keep the code in other js files tidied up\r\n */\r\n\r\n/**\r\n * Create source element and append it to picture element.\r\n */\r\nexport const addImageSourceToPicture = (picture, srcset, media) => {\r\n    const source = document.createElement('source');\r\n    if (media !== undefined) {\r\n        source.media = media;\r\n    }\r\n    source.setAttribute('data-srcset', srcset);\r\n    picture.append(source);\r\n};\r\n\r\n/**\r\n * Extract extension from filename.\r\n */\r\nexport const fileExtension = (filename) => {\r\n    return filename.split('.').pop();\r\n};\r\n\r\n/**\r\n * Get filename without extension.\r\n */\r\nexport const filenameWithoutExtension = (filename) => {\r\n    return filename.replace(/.[^.]+$/, '');\r\n};\r\n\r\n/**\r\n * Get all possible names of an image depending on its size (small, medium, large).\r\n */\r\nexport const imageNamesBySize = (imageFilename) => {\r\n    const imageExtension = 'jpg';\r\n    const filenames = {};\r\n    filenames.small = `${imageFilename}-small.${imageExtension}`;\r\n    filenames.medium = `${imageFilename}-medium.${imageExtension}`;\r\n    filenames.large = `${imageFilename}-large.${imageExtension}`;\r\n\r\n    return filenames;\r\n};\r\n\r\n/**\r\n * Include google maps api on the fly.\r\n * Google map is lazy loaded using the IntersectionObserver API.\r\n * The code for this function is from the \r\n * Lazy loading Google Maps with the IntersectionObserver API article:\r\n * https://walterebert.com/blog/lazy-loading-google-maps-with-the-intersection-observer-api/\r\n * The only thing changed is that muicss loadJS is used instead of \r\n * Filament Group loadJS used in the original, to load js scripts on the fly.\r\n * Check for offline state to not load google maps script is added.\r\n */\r\nexport const getGoogleMapsApi = () => {\r\n    'use strict';\r\n\r\n    const options = {\r\n        rootMargin: '400px',\r\n        threshold: 0\r\n    };\r\n\r\n    const map = document.getElementById('map');\r\n\r\n    // Lazy loading Google Maps with the IntersectionObserver API\r\n    const observer = new IntersectionObserver(\r\n            (entries, observer) => {\r\n        // Detect intersection https://calendar.perfplanet.com/2017/progressive-image-loading-using-intersection-observer-and-sqip/#comment-102838\r\n        const isIntersecting = typeof entries[0].isIntersecting === 'boolean' ? entries[0].isIntersecting : entries[0].intersectionRatio > 0;\r\n        if (isIntersecting) {\r\n            // Check if page is offline\r\n            if ((` ${map.className} `).replace(/[\\n\\t]/g, ' ').indexOf(' offline ') > -1) {\r\n                // If page is offline, show corresponding message on map\r\n                if (!document.getElementById('map-offline')) {\r\n                    // Display a map load failure message\r\n                    const mapOffline = document.createElement('div');\r\n                    mapOffline.id = 'map-offline';\r\n\r\n                    const mapOfflineMessage = document.createElement('span');\r\n                    mapOfflineMessage.innerHTML = 'No internet connection. Failed to load map.';\r\n                    mapOfflineMessage.id = 'map-offline-message';\r\n                    mapOffline.appendChild(mapOfflineMessage);\r\n\r\n                    map.append(mapOffline);\r\n                }\r\n            } else {\r\n                // Load google maps\r\n                // Scripts are loaded using muicss loadJS: https://github.com/muicss/loadjs\r\n                loadjs(['https://maps.googleapis.com/maps/api/js?key=AIzaSyBzXDGrWxj1GsJUbo9ZKSJPz07o2K1ljgc&libraries=places&callback=initMap']);\r\n                observer.unobserve(map);\r\n            }\r\n        }\r\n    }, options);\r\n\r\n    observer.observe(map);\r\n};\r\n\r\n/**\r\n * Include LazyLoad plugin: https://www.andreaverlicchi.eu/lazyload/#recipes\r\n */\r\nexport const getLazyLoadPlugin = () => {\r\n    // Conditionally load the best version of LazyLoad depending on the browser's support of the IntersectionObserver API. \r\n    (function(w, d) {\r\n        var b = d.getElementsByTagName('body')[0];\r\n        var s = d.createElement(\"script\");\r\n        s.async = true;\r\n        var v = !(\"IntersectionObserver\" in w) ? \"8.7.1\" : \"10.5.2\";\r\n        s.src = \"https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/\" + v + \"/lazyload.min.js\";\r\n        w.lazyLoadOptions = {\r\n            elements_selector: '.lazy'\r\n        }; // Your options here. See \"recipes\" for more information about async.\r\n        b.appendChild(s);\r\n    }(window, document));\r\n};\r\n\r\n/**\r\n * Convert unix timestamp to date string.\r\n */\r\nexport const timestampToDate = timestamp => {\r\n    const date = new Date(timestamp);\r\n\r\n    const day = date.getDate();\r\n    const month = getMonthName(date.getMonth());\r\n    const year = date.getFullYear();\r\n\r\n    return `${month} ${day}, ${year}`;\r\n};\r\n\r\n/**\r\n * Return month's name depending on its number.\r\n * Code is from https://www.w3schools.com/jsref/jsref_getmonth.asp\r\n */\r\nconst getMonthName = (monthIndex) => {\r\n    const month = new Array();\r\n    month[0] = 'January';\r\n    month[1] = 'February';\r\n    month[2] = 'March';\r\n    month[3] = 'April';\r\n    month[4] = 'May';\r\n    month[5] = 'June';\r\n    month[6] = 'July';\r\n    month[7] = 'August';\r\n    month[8] = 'September';\r\n    month[9] = 'October';\r\n    month[10] = 'November';\r\n    month[11] = 'December';\r\n\r\n    return month[monthIndex];\r\n};\r\n","\n/**\n * When source maps are enabled, `style-loader` uses a link element with a data-uri to\n * embed the css on the page. This breaks all relative urls because now they are relative to a\n * bundle instead of the current page.\n *\n * One solution is to only use full urls, but that may be impossible.\n *\n * Instead, this function \"fixes\" the relative urls to be absolute according to the current page location.\n *\n * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.\n *\n */\n\nmodule.exports = function (css) {\n  // get current location\n  var location = typeof window !== \"undefined\" && window.location;\n\n  if (!location) {\n    throw new Error(\"fixUrls requires window.location\");\n  }\n\n\t// blank or null?\n\tif (!css || typeof css !== \"string\") {\n\t  return css;\n  }\n\n  var baseUrl = location.protocol + \"//\" + location.host;\n  var currentDir = baseUrl + location.pathname.replace(/\\/[^\\/]*$/, \"/\");\n\n\t// convert each url(...)\n\t/*\n\tThis regular expression is just a way to recursively match brackets within\n\ta string.\n\n\t /url\\s*\\(  = Match on the word \"url\" with any whitespace after it and then a parens\n\t   (  = Start a capturing group\n\t     (?:  = Start a non-capturing group\n\t         [^)(]  = Match anything that isn't a parentheses\n\t         |  = OR\n\t         \\(  = Match a start parentheses\n\t             (?:  = Start another non-capturing groups\n\t                 [^)(]+  = Match anything that isn't a parentheses\n\t                 |  = OR\n\t                 \\(  = Match a start parentheses\n\t                     [^)(]*  = Match anything that isn't a parentheses\n\t                 \\)  = Match a end parentheses\n\t             )  = End Group\n              *\\) = Match anything and then a close parens\n          )  = Close non-capturing group\n          *  = Match anything\n       )  = Close capturing group\n\t \\)  = Match a close parens\n\n\t /gi  = Get all matches, not the first.  Be case insensitive.\n\t */\n\tvar fixedCss = css.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi, function(fullMatch, origUrl) {\n\t\t// strip quotes (if they exist)\n\t\tvar unquotedOrigUrl = origUrl\n\t\t\t.trim()\n\t\t\t.replace(/^\"(.*)\"$/, function(o, $1){ return $1; })\n\t\t\t.replace(/^'(.*)'$/, function(o, $1){ return $1; });\n\n\t\t// already a full url? no change\n\t\tif (/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/|\\s*$)/i.test(unquotedOrigUrl)) {\n\t\t  return fullMatch;\n\t\t}\n\n\t\t// convert the url to a full url\n\t\tvar newUrl;\n\n\t\tif (unquotedOrigUrl.indexOf(\"//\") === 0) {\n\t\t  \t//TODO: should we add protocol?\n\t\t\tnewUrl = unquotedOrigUrl;\n\t\t} else if (unquotedOrigUrl.indexOf(\"/\") === 0) {\n\t\t\t// path should be relative to the base url\n\t\t\tnewUrl = baseUrl + unquotedOrigUrl; // already starts with '/'\n\t\t} else {\n\t\t\t// path should be relative to current directory\n\t\t\tnewUrl = currentDir + unquotedOrigUrl.replace(/^\\.\\//, \"\"); // Strip leading './'\n\t\t}\n\n\t\t// send back the fixed url(...)\n\t\treturn \"url(\" + JSON.stringify(newUrl) + \")\";\n\t});\n\n\t// send back the fixed css\n\treturn fixedCss;\n};\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\nvar stylesInDom = {};\n\nvar\tmemoize = function (fn) {\n\tvar memo;\n\n\treturn function () {\n\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\treturn memo;\n\t};\n};\n\nvar isOldIE = memoize(function () {\n\t// Test for IE <= 9 as proposed by Browserhacks\n\t// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n\t// Tests for existence of standard globals is to allow style-loader\n\t// to operate correctly into non-standard environments\n\t// @see https://github.com/webpack-contrib/style-loader/issues/177\n\treturn window && document && document.all && !window.atob;\n});\n\nvar getTarget = function (target) {\n  return document.querySelector(target);\n};\n\nvar getElement = (function (fn) {\n\tvar memo = {};\n\n\treturn function(target) {\n                // If passing function in options, then use it for resolve \"head\" element.\n                // Useful for Shadow Root style i.e\n                // {\n                //   insertInto: function () { return document.querySelector(\"#foo\").shadowRoot }\n                // }\n                if (typeof target === 'function') {\n                        return target();\n                }\n                if (typeof memo[target] === \"undefined\") {\n\t\t\tvar styleTarget = getTarget.call(this, target);\n\t\t\t// Special case to return head of iframe instead of iframe itself\n\t\t\tif (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n\t\t\t\ttry {\n\t\t\t\t\t// This will throw an exception if access to iframe is blocked\n\t\t\t\t\t// due to cross-origin restrictions\n\t\t\t\t\tstyleTarget = styleTarget.contentDocument.head;\n\t\t\t\t} catch(e) {\n\t\t\t\t\tstyleTarget = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\tmemo[target] = styleTarget;\n\t\t}\n\t\treturn memo[target]\n\t};\n})();\n\nvar singleton = null;\nvar\tsingletonCounter = 0;\nvar\tstylesInsertedAtTop = [];\n\nvar\tfixUrls = require(\"./urls\");\n\nmodule.exports = function(list, options) {\n\tif (typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif (typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\n\toptions.attrs = typeof options.attrs === \"object\" ? options.attrs : {};\n\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (!options.singleton && typeof options.singleton !== \"boolean\") options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the <head> element\n        if (!options.insertInto) options.insertInto = \"head\";\n\n\t// By default, add <style> tags to the bottom of the target\n\tif (!options.insertAt) options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list, options);\n\n\taddStylesToDom(styles, options);\n\n\treturn function update (newList) {\n\t\tvar mayRemove = [];\n\n\t\tfor (var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList, options);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\n\t\tfor (var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor (var j = 0; j < domStyle.parts.length; j++) domStyle.parts[j]();\n\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n};\n\nfunction addStylesToDom (styles, options) {\n\tfor (var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles (list, options) {\n\tvar styles = [];\n\tvar newStyles = {};\n\n\tfor (var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = options.base ? item[0] + options.base : item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\n\t\tif(!newStyles[id]) styles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse newStyles[id].parts.push(part);\n\t}\n\n\treturn styles;\n}\n\nfunction insertStyleElement (options, style) {\n\tvar target = getElement(options.insertInto)\n\n\tif (!target) {\n\t\tthrow new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");\n\t}\n\n\tvar lastStyleElementInsertedAtTop = stylesInsertedAtTop[stylesInsertedAtTop.length - 1];\n\n\tif (options.insertAt === \"top\") {\n\t\tif (!lastStyleElementInsertedAtTop) {\n\t\t\ttarget.insertBefore(style, target.firstChild);\n\t\t} else if (lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\ttarget.insertBefore(style, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\ttarget.appendChild(style);\n\t\t}\n\t\tstylesInsertedAtTop.push(style);\n\t} else if (options.insertAt === \"bottom\") {\n\t\ttarget.appendChild(style);\n\t} else if (typeof options.insertAt === \"object\" && options.insertAt.before) {\n\t\tvar nextSibling = getElement(options.insertInto + \" \" + options.insertAt.before);\n\t\ttarget.insertBefore(style, nextSibling);\n\t} else {\n\t\tthrow new Error(\"[Style Loader]\\n\\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\\n Must be 'top', 'bottom', or Object.\\n (https://github.com/webpack-contrib/style-loader#insertat)\\n\");\n\t}\n}\n\nfunction removeStyleElement (style) {\n\tif (style.parentNode === null) return false;\n\tstyle.parentNode.removeChild(style);\n\n\tvar idx = stylesInsertedAtTop.indexOf(style);\n\tif(idx >= 0) {\n\t\tstylesInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement (options) {\n\tvar style = document.createElement(\"style\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\n\taddAttrs(style, options.attrs);\n\tinsertStyleElement(options, style);\n\n\treturn style;\n}\n\nfunction createLinkElement (options) {\n\tvar link = document.createElement(\"link\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\toptions.attrs.rel = \"stylesheet\";\n\n\taddAttrs(link, options.attrs);\n\tinsertStyleElement(options, link);\n\n\treturn link;\n}\n\nfunction addAttrs (el, attrs) {\n\tObject.keys(attrs).forEach(function (key) {\n\t\tel.setAttribute(key, attrs[key]);\n\t});\n}\n\nfunction addStyle (obj, options) {\n\tvar style, update, remove, result;\n\n\t// If a transform function was defined, run it on the css\n\tif (options.transform && obj.css) {\n\t    result = options.transform(obj.css);\n\n\t    if (result) {\n\t    \t// If transform returns a value, use that instead of the original css.\n\t    \t// This allows running runtime transformations on the css.\n\t    \tobj.css = result;\n\t    } else {\n\t    \t// If the transform function returns a falsy value, don't add this css.\n\t    \t// This allows conditional loading of css\n\t    \treturn function() {\n\t    \t\t// noop\n\t    \t};\n\t    }\n\t}\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\n\t\tstyle = singleton || (singleton = createStyleElement(options));\n\n\t\tupdate = applyToSingletonTag.bind(null, style, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, style, styleIndex, true);\n\n\t} else if (\n\t\tobj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\"\n\t) {\n\t\tstyle = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, style, options);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\n\t\t\tif(style.href) URL.revokeObjectURL(style.href);\n\t\t};\n\t} else {\n\t\tstyle = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, style);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle (newObj) {\n\t\tif (newObj) {\n\t\t\tif (\n\t\t\t\tnewObj.css === obj.css &&\n\t\t\t\tnewObj.media === obj.media &&\n\t\t\t\tnewObj.sourceMap === obj.sourceMap\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag (style, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (style.styleSheet) {\n\t\tstyle.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = style.childNodes;\n\n\t\tif (childNodes[index]) style.removeChild(childNodes[index]);\n\n\t\tif (childNodes.length) {\n\t\t\tstyle.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyle.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag (style, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyle.setAttribute(\"media\", media)\n\t}\n\n\tif(style.styleSheet) {\n\t\tstyle.styleSheet.cssText = css;\n\t} else {\n\t\twhile(style.firstChild) {\n\t\t\tstyle.removeChild(style.firstChild);\n\t\t}\n\n\t\tstyle.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink (link, options, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\t/*\n\t\tIf convertToAbsoluteUrls isn't defined, but sourcemaps are enabled\n\t\tand there is no publicPath defined then lets turn convertToAbsoluteUrls\n\t\ton by default.  Otherwise default to the convertToAbsoluteUrls option\n\t\tdirectly\n\t*/\n\tvar autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;\n\n\tif (options.convertToAbsoluteUrls || autoFixUrls) {\n\t\tcss = fixUrls(css);\n\t}\n\n\tif (sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = link.href;\n\n\tlink.href = URL.createObjectURL(blob);\n\n\tif(oldSrc) URL.revokeObjectURL(oldSrc);\n}\n","\nvar content = require(\"!!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js!./styles.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js!./styles.css\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js!./styles.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","import './../css/styles.css';\r\nimport {addImageSourceToPicture, imageNamesBySize, getGoogleMapsApi, getLazyLoadPlugin} from './helper.js';\r\nimport DBHelper from './dbhelper.js';\r\n\r\nlet restaurants;\r\nlet neighborhoods = [];\r\nlet cuisines = [];\r\nvar map\r\nvar markers = []\r\n\r\n/**\r\n * Fetch restaurants as soon as the page is loaded.\r\n */\r\ndocument.addEventListener('DOMContentLoaded', (event) => {\r\n    updateRestaurants();\r\n});\r\ndocument.getElementById('cuisines-select').addEventListener('change', (event) => {\r\n    updateRestaurants();\r\n});\r\ndocument.getElementById('neighborhoods-select').addEventListener('change', (event) => {\r\n    updateRestaurants();\r\n});\r\n\r\n/**\r\n * Set neighborhoods HTML.\r\n */\r\nconst fillNeighborhoodsHTML = (neighborhoods = self.neighborhoods) => {\r\n    const select = document.getElementById('neighborhoods-select');\r\n    neighborhoods.forEach(neighborhood => {\r\n        const option = document.createElement('option');\r\n        option.innerHTML = neighborhood;\r\n        option.value = neighborhood;\r\n        select.append(option);\r\n    });\r\n}\r\n\r\n/**\r\n * Set cuisines HTML.\r\n */\r\nconst fillCuisinesHTML = (cuisines = self.cuisines) => {\r\n    const select = document.getElementById('cuisines-select');\r\n\r\n    cuisines.forEach(cuisine => {\r\n        const option = document.createElement('option');\r\n        option.innerHTML = cuisine;\r\n        option.value = cuisine;\r\n        select.append(option);\r\n    });\r\n}\r\n\r\n/**\r\n * Initialize Google map, called from HTML.\r\n */\r\nwindow.initMap = () => {\r\n    let loc = {\r\n        lat: 40.722216,\r\n        lng: -73.987501\r\n    };\r\n    self.map = new google.maps.Map(document.getElementById('map'), {\r\n        zoom: 12,\r\n        center: loc,\r\n        scrollwheel: false\r\n    });\r\n\r\n    // Add markers to the map after being initialized\r\n    addMarkersToMap();\r\n}\r\n\r\n/**\r\n * Update page and map for current restaurants.\r\n */\r\nconst updateRestaurants = () => {\r\n    const cSelect = document.getElementById('cuisines-select');\r\n    const nSelect = document.getElementById('neighborhoods-select');\r\n\r\n    const cIndex = cSelect.selectedIndex;\r\n    const nIndex = nSelect.selectedIndex;\r\n\r\n    const cuisine = cSelect[cIndex].value;\r\n    const neighborhood = nSelect[nIndex].value;\r\n\r\n    DBHelper.fetchRestaurantByCuisineAndNeighborhood(cuisine, neighborhood, (error, restaurants) => {\r\n        if (error) { // Got an error!\r\n            console.error(error);\r\n        } else {\r\n            resetRestaurants(restaurants);\r\n            fillRestaurantsHTML();\r\n            // Include LazyLoad plugin\r\n            getLazyLoadPlugin();\r\n            // Include maps api dynamically only after everything else has been done\r\n            getGoogleMapsApi();\r\n        }\r\n    })\r\n}\r\n\r\n/**\r\n * Clear current restaurants, their HTML and remove their map markers.\r\n */\r\nconst resetRestaurants = (restaurants) => {\r\n    // Remove all restaurants\r\n    self.restaurants = [];\r\n    const ul = document.getElementById('restaurants-list');\r\n    ul.innerHTML = '';\r\n\r\n    // Remove all map markers\r\n    if (self.markers) {\r\n        self.markers.forEach(m => m.setMap(null));\r\n    }\r\n    self.markers = [];\r\n    self.restaurants = restaurants;\r\n}\r\n\r\n/**\r\n * Create all restaurants HTML and add them to the webpage.\r\n */\r\nconst fillRestaurantsHTML = (restaurants = self.restaurants) => {\r\n    const ul = document.getElementById('restaurants-list');\r\n    restaurants.forEach(restaurant => {\r\n        if (DBHelper.addRestaurants()) {\r\n            DBHelper.addRestaurantToDatabase(restaurant);\r\n        }\r\n        ul.append(createRestaurantHTML(restaurant));\r\n\r\n        if (!self.neighborhoods) {\r\n            self.neighborhoods = [];\r\n        }\r\n        if (!self.neighborhoods.includes(restaurant.neighborhood)) {\r\n            self.neighborhoods.push(restaurant.neighborhood);\r\n        }\r\n\r\n        if (!self.cuisines) {\r\n            self.cuisines = [];\r\n        }\r\n        if (!self.cuisines.includes(restaurant.cuisine_type)) {\r\n            self.cuisines.push(restaurant.cuisine_type);\r\n        }\r\n    });\r\n\r\n    fillNeighborhoodsHTML();\r\n    fillCuisinesHTML();\r\n}\r\n\r\n/**\r\n * Create restaurant HTML.\r\n */\r\nconst createRestaurantHTML = (restaurant) => {\r\n    const li = document.createElement('li');\r\n\r\n    // create picture element for restaurant image in restaurant list\r\n    const picture = document.createElement('picture');\r\n    const image = document.createElement('img');\r\n    image.className = 'restaurant-img lazy';\r\n    image.alt = restaurant.name;\r\n\r\n    const imageFilename = DBHelper.imageUrlForRestaurant(restaurant);\r\n    if (imageFilename == 'noimg') {\r\n        // If restaurant has not an image, display a no image svg\r\n        // and use its corresponding png as a fallback.\r\n        // Author of the noimg.svg and noimg.png is credited at page's footer.\r\n        const noImgFallback = `${imageFilename}.png`;\r\n        addImageSourceToPicture(picture, `${imageFilename}.svg`);\r\n        addImageSourceToPicture(picture, noImgFallback);\r\n\r\n        image.setAttribute('data-src', noImgFallback);\r\n        image.className += ' noimg';\r\n        // TODO: Fix noimg png fallback in IE\r\n    } else {\r\n        // get all possible names of an image depending on its size (small, medium, large)\r\n        const imagesResized = imageNamesBySize(imageFilename);\r\n        // add source to picture element for medium screens\r\n        addImageSourceToPicture(picture, imagesResized.medium, '(min-width: 363px) and (max-width:479px)');\r\n\r\n        image.setAttribute('data-src', imagesResized.small);\r\n    }\r\n\r\n    picture.append(image);\r\n    li.append(picture);\r\n\r\n    const name = document.createElement('h3');\r\n    li.append(name);\r\n\r\n    const more = document.createElement('a');\r\n    more.href = DBHelper.urlForRestaurant(restaurant);\r\n    more.innerHTML = restaurant.name;\r\n    more.tabIndex = 0;\r\n    name.append(more);\r\n\r\n    const neighborhood = document.createElement('p');\r\n    neighborhood.innerHTML = restaurant.neighborhood;\r\n    li.append(neighborhood);\r\n\r\n    const address = document.createElement('p');\r\n    address.innerHTML = restaurant.address;\r\n    li.append(address);\r\n\r\n    return li\r\n}\r\n\r\n/**\r\n * Add markers for current restaurants to the map.\r\n */\r\nconst addMarkersToMap = (restaurants = self.restaurants) => {\r\n    restaurants.forEach(restaurant => {\r\n        // Add marker to the map\r\n        const marker = DBHelper.mapMarkerForRestaurant(restaurant, self.map);\r\n        google.maps.event.addListener(marker, 'click', () => {\r\n            window.location.href = marker.url\r\n        });\r\n        self.markers.push(marker);\r\n    });\r\n}\r\n"],"sourceRoot":""}