{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/idb/lib/idb.js","webpack:///./src/js/dbhelper.js","webpack:///./src/js/helper.js","webpack:///./node_modules/style-loader/lib/urls.js","webpack:///./node_modules/style-loader/lib/addStyles.js","webpack:///./src/css/styles.css","webpack:///./src/js/restaurant_info.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","default","object","property","prototype","hasOwnProperty","p","s","e","promisifyRequest","request","Promise","resolve","reject","onsuccess","result","onerror","error","promisifyRequestCall","obj","method","args","apply","then","proxyProperties","ProxyClass","targetProp","properties","forEach","prop","this","set","val","proxyRequestMethods","Constructor","arguments","proxyMethods","proxyCursorRequestMethods","Cursor","Index","index","_index","cursor","_cursor","_request","ObjectStore","store","_store","Transaction","idbTransaction","_tx","complete","oncomplete","onabort","UpgradeDB","db","oldVersion","transaction","_db","DB","IDBIndex","IDBCursor","methodName","createIndex","IDBObjectStore","objectStore","IDBTransaction","createObjectStore","IDBDatabase","funcName","replace","arr","Array","slice","callback","length","nativeObject","getAll","query","count","instance","items","iterateCursor","push","continue","exp","open","version","upgradeCallback","indexedDB","onupgradeneeded","event","delete","configurable","writable","a","DBHelper","addRestaurants","navigator","serviceWorker","idb","upgradeDb","keyPath","autoIncrement","fetch","DATABASE_URL","response","json","restaurants","catch","id","getRestaurantFromDbById","restaurant","is_favorite","addRestaurantToDatabase","status","DATABASE_PROMISE","Number","msg","console","log","cuisine","fetchRestaurants","results","filter","cuisine_type","neighborhood","tx","viewRestaurants","neighborhoods","map","v","uniqueNeighborhoods","indexOf","cuisines","uniqueCuisines","photograph","google","maps","Marker","position","latlng","title","url","urlForRestaurant","animation","Animation","DROP","put","restaurant_id","reviews","DATABASE_URL_REVIEWS","review","openDatabase","addImageSourceToPicture","picture","srcset","media","source","document","createElement","setAttribute","append","fileExtension","filename","split","pop","filenameWithoutExtension","imageNamesBySize","imageFilename","filenames","small","medium","large","getGoogleMapsApi","getElementById","IntersectionObserver","entries","observer","isIntersecting","intersectionRatio","className","mapOffline","mapOfflineMessage","innerHTML","appendChild","loadjs","unobserve","rootMargin","threshold","observe","getLazyLoadPlugin","w","b","getElementsByTagName","async","src","lazyLoadOptions","elements_selector","window","timestampToDate","timestamp","date","Date","day","getDate","getMonthName","getMonth","getFullYear","monthIndex","month","css","location","Error","baseUrl","protocol","host","currentDir","pathname","fullMatch","origUrl","newUrl","unquotedOrigUrl","trim","$1","test","JSON","stringify","stylesInDom","isOldIE","fn","memo","all","atob","getElement","target","styleTarget","querySelector","HTMLIFrameElement","contentDocument","head","singleton","singletonCounter","stylesInsertedAtTop","fixUrls","addStylesToDom","styles","options","item","domStyle","refs","j","parts","addStyle","listToStyles","list","newStyles","base","part","sourceMap","insertStyleElement","style","insertInto","lastStyleElementInsertedAtTop","insertAt","nextSibling","insertBefore","firstChild","before","removeStyleElement","parentNode","removeChild","idx","splice","createStyleElement","attrs","type","addAttrs","el","keys","update","remove","transform","styleIndex","applyToSingletonTag","URL","createObjectURL","revokeObjectURL","Blob","btoa","link","rel","autoFixUrls","convertToAbsoluteUrls","unescape","encodeURIComponent","blob","oldSrc","href","styleSheet","cssText","createTextNode","newObj","DEBUG","newList","mayRemove","replaceText","textStore","replacement","Boolean","join","cssNode","childNodes","content","hmr","locals","_helper","addEventListener","fetchRestaurantFromURL","fillRestaurantHTML","fillBreadcrumb","isfavoriteButton","isfavoriteIcon","getParameterByName","classList","contains","unfavoriteRestaurantById","add","favoriteRestaurantById","addReviewForm","preventDefault","loadingImg","display","reviewSubmit","disabled","messageSuccess","messageError","messageErrorEmpty","addRreviewName","addRreviewRating","addRreviewComments","parseInt","rating","comments","createdAt","now","valid_data","empty_data","addReviewToDatabase","prepend","createReviewHTML","reset","initMap","self","Map","zoom","center","scrollwheel","mapMarkerForRestaurant","fetchRestaurantById","address","image","alt","imageUrlForRestaurant","restaurantImgSourcesPicture","noImgFallback","imagesResized","operating_hours","fillRestaurantHoursHTML","fillReviewsHTML","operatingHours","hours","row","time","restaurantId","container","fetchReviewsByRestaurantId","reviews_data","addToDb","noReviews","ul","li","dateString","tabIndex","breadcrumb","RegExp","exec","decodeURIComponent"],"mappings":"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","file":"restaurant_info.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 10);\n","'use strict';\n\n(function() {\n  function toArray(arr) {\n    return Array.prototype.slice.call(arr);\n  }\n\n  function promisifyRequest(request) {\n    return new Promise(function(resolve, reject) {\n      request.onsuccess = function() {\n        resolve(request.result);\n      };\n\n      request.onerror = function() {\n        reject(request.error);\n      };\n    });\n  }\n\n  function promisifyRequestCall(obj, method, args) {\n    var request;\n    var p = new Promise(function(resolve, reject) {\n      request = obj[method].apply(obj, args);\n      promisifyRequest(request).then(resolve, reject);\n    });\n\n    p.request = request;\n    return p;\n  }\n\n  function promisifyCursorRequestCall(obj, method, args) {\n    var p = promisifyRequestCall(obj, method, args);\n    return p.then(function(value) {\n      if (!value) return;\n      return new Cursor(value, p.request);\n    });\n  }\n\n  function proxyProperties(ProxyClass, targetProp, properties) {\n    properties.forEach(function(prop) {\n      Object.defineProperty(ProxyClass.prototype, prop, {\n        get: function() {\n          return this[targetProp][prop];\n        },\n        set: function(val) {\n          this[targetProp][prop] = val;\n        }\n      });\n    });\n  }\n\n  function proxyRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function proxyMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return this[targetProp][prop].apply(this[targetProp], arguments);\n      };\n    });\n  }\n\n  function proxyCursorRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyCursorRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function Index(index) {\n    this._index = index;\n  }\n\n  proxyProperties(Index, '_index', [\n    'name',\n    'keyPath',\n    'multiEntry',\n    'unique'\n  ]);\n\n  proxyRequestMethods(Index, '_index', IDBIndex, [\n    'get',\n    'getKey',\n    'getAll',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(Index, '_index', IDBIndex, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  function Cursor(cursor, request) {\n    this._cursor = cursor;\n    this._request = request;\n  }\n\n  proxyProperties(Cursor, '_cursor', [\n    'direction',\n    'key',\n    'primaryKey',\n    'value'\n  ]);\n\n  proxyRequestMethods(Cursor, '_cursor', IDBCursor, [\n    'update',\n    'delete'\n  ]);\n\n  // proxy 'next' methods\n  ['advance', 'continue', 'continuePrimaryKey'].forEach(function(methodName) {\n    if (!(methodName in IDBCursor.prototype)) return;\n    Cursor.prototype[methodName] = function() {\n      var cursor = this;\n      var args = arguments;\n      return Promise.resolve().then(function() {\n        cursor._cursor[methodName].apply(cursor._cursor, args);\n        return promisifyRequest(cursor._request).then(function(value) {\n          if (!value) return;\n          return new Cursor(value, cursor._request);\n        });\n      });\n    };\n  });\n\n  function ObjectStore(store) {\n    this._store = store;\n  }\n\n  ObjectStore.prototype.createIndex = function() {\n    return new Index(this._store.createIndex.apply(this._store, arguments));\n  };\n\n  ObjectStore.prototype.index = function() {\n    return new Index(this._store.index.apply(this._store, arguments));\n  };\n\n  proxyProperties(ObjectStore, '_store', [\n    'name',\n    'keyPath',\n    'indexNames',\n    'autoIncrement'\n  ]);\n\n  proxyRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'put',\n    'add',\n    'delete',\n    'clear',\n    'get',\n    'getAll',\n    'getKey',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  proxyMethods(ObjectStore, '_store', IDBObjectStore, [\n    'deleteIndex'\n  ]);\n\n  function Transaction(idbTransaction) {\n    this._tx = idbTransaction;\n    this.complete = new Promise(function(resolve, reject) {\n      idbTransaction.oncomplete = function() {\n        resolve();\n      };\n      idbTransaction.onerror = function() {\n        reject(idbTransaction.error);\n      };\n      idbTransaction.onabort = function() {\n        reject(idbTransaction.error);\n      };\n    });\n  }\n\n  Transaction.prototype.objectStore = function() {\n    return new ObjectStore(this._tx.objectStore.apply(this._tx, arguments));\n  };\n\n  proxyProperties(Transaction, '_tx', [\n    'objectStoreNames',\n    'mode'\n  ]);\n\n  proxyMethods(Transaction, '_tx', IDBTransaction, [\n    'abort'\n  ]);\n\n  function UpgradeDB(db, oldVersion, transaction) {\n    this._db = db;\n    this.oldVersion = oldVersion;\n    this.transaction = new Transaction(transaction);\n  }\n\n  UpgradeDB.prototype.createObjectStore = function() {\n    return new ObjectStore(this._db.createObjectStore.apply(this._db, arguments));\n  };\n\n  proxyProperties(UpgradeDB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(UpgradeDB, '_db', IDBDatabase, [\n    'deleteObjectStore',\n    'close'\n  ]);\n\n  function DB(db) {\n    this._db = db;\n  }\n\n  DB.prototype.transaction = function() {\n    return new Transaction(this._db.transaction.apply(this._db, arguments));\n  };\n\n  proxyProperties(DB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(DB, '_db', IDBDatabase, [\n    'close'\n  ]);\n\n  // Add cursor iterators\n  // TODO: remove this once browsers do the right thing with promises\n  ['openCursor', 'openKeyCursor'].forEach(function(funcName) {\n    [ObjectStore, Index].forEach(function(Constructor) {\n      // Don't create iterateKeyCursor if openKeyCursor doesn't exist.\n      if (!(funcName in Constructor.prototype)) return;\n\n      Constructor.prototype[funcName.replace('open', 'iterate')] = function() {\n        var args = toArray(arguments);\n        var callback = args[args.length - 1];\n        var nativeObject = this._store || this._index;\n        var request = nativeObject[funcName].apply(nativeObject, args.slice(0, -1));\n        request.onsuccess = function() {\n          callback(request.result);\n        };\n      };\n    });\n  });\n\n  // polyfill getAll\n  [Index, ObjectStore].forEach(function(Constructor) {\n    if (Constructor.prototype.getAll) return;\n    Constructor.prototype.getAll = function(query, count) {\n      var instance = this;\n      var items = [];\n\n      return new Promise(function(resolve) {\n        instance.iterateCursor(query, function(cursor) {\n          if (!cursor) {\n            resolve(items);\n            return;\n          }\n          items.push(cursor.value);\n\n          if (count !== undefined && items.length == count) {\n            resolve(items);\n            return;\n          }\n          cursor.continue();\n        });\n      });\n    };\n  });\n\n  var exp = {\n    open: function(name, version, upgradeCallback) {\n      var p = promisifyRequestCall(indexedDB, 'open', [name, version]);\n      var request = p.request;\n\n      if (request) {\n        request.onupgradeneeded = function(event) {\n          if (upgradeCallback) {\n            upgradeCallback(new UpgradeDB(request.result, event.oldVersion, request.transaction));\n          }\n        };\n      }\n\n      return p.then(function(db) {\n        return new DB(db);\n      });\n    },\n    delete: function(name) {\n      return promisifyRequestCall(indexedDB, 'deleteDatabase', [name]);\n    }\n  };\n\n  if (typeof module !== 'undefined') {\n    module.exports = exp;\n    module.exports.default = module.exports;\n  }\n  else {\n    self.idb = exp;\n  }\n}());\n","import idb from 'idb';\r\n\r\n/**\r\n * Common database helper functions.\r\n */\r\nclass DBHelper {\r\n\r\n    /**\r\n     * Database Promise.\r\n     * Returns the constant defined after the DBHelper class \r\n     * with the opened database.\r\n     */\r\n    static get DATABASE_PROMISE() {\r\n        return DATABASE_PROMISE;\r\n    }\r\n\r\n    /**\r\n     * Database URL.\r\n     * Change this to restaurants.json file location on your server.\r\n     */\r\n    static get DATABASE_URL() {\r\n        const port = 1337; // Change this to your server port\r\n        return `http://localhost:${port}/restaurants`;\r\n    }\r\n\r\n    /**\r\n     * Database URL Reviews.\r\n     * URL for access to reviews entity.\r\n     */\r\n    static get DATABASE_URL_REVIEWS() {\r\n        const port = 1337; // Change this to your server port\r\n        return `http://localhost:${port}/reviews`;\r\n    }\r\n\r\n    /**\r\n     * Call the variable defined after the DBHelper class which is a bool\r\n     * that indicates whether to store a restaurant into database\r\n     * before adding its html.\r\n     */\r\n    static addRestaurants() {\r\n        return addRestaurants;\r\n    }\r\n\r\n    static openDatabase() {\r\n        // If the browser doesn't support service worker,\r\n        // we don't care about having a database\r\n        if (!navigator.serviceWorker) {\r\n            return Promise.resolve();\r\n        }\r\n\r\n        return  idb.open('restaurants-db', 2, upgradeDb => {\r\n            switch (upgradeDb.oldVersion) {\r\n                case 0:\r\n                    upgradeDb.createObjectStore('restaurants', {keyPath: 'id'});\r\n                    const restaurantsStore = upgradeDb.transaction.objectStore('restaurants');\r\n                    restaurantsStore.createIndex('id', 'id');\r\n                case 1:\r\n                    // Add an AI id_local attribute for reviews and use it as keypath instead of id, \r\n                    // to deal with newly created reviews that don't have an id.\r\n                    upgradeDb.createObjectStore('reviews', {keyPath: 'id_local', autoIncrement: true});\r\n                    const reviewsStore = upgradeDb.transaction.objectStore('reviews');\r\n                    reviewsStore.createIndex('restaurant_id', 'restaurant_id');\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Fetch all restaurants.\r\n     */\r\n    static fetchRestaurants(callback) {\r\n        fetch(DBHelper.DATABASE_URL)\r\n                .then(response => response.json())\r\n                .then(restaurants => callback(null, restaurants))\r\n                .catch(error => callback(error, null));\r\n    }\r\n\r\n    /**\r\n     * Favorite a restaurant by its ID.\r\n     * Return Promise to avoid callback functions as parameters.\r\n     */\r\n    static favoriteRestaurantById(id) {\r\n        return new Promise((resolve, reject) => {\r\n            // Search idb for restaurant\r\n            DBHelper.getRestaurantFromDbById(id).then(restaurant => {\r\n                if (restaurant) { // Got the restaurant\r\n                    // If restaurant found in idb, update record\r\n                    restaurant.is_favorite = true;\r\n                    DBHelper.addRestaurantToDatabase(restaurant);\r\n                }\r\n\r\n                // Update data in server that restaurant is favorite\r\n                fetch(`${DBHelper.DATABASE_URL}/${id}/?is_favorite=true`, {method: 'PUT'})\r\n                        .then(response => {\r\n                            if (response.status == 200) {\r\n                                resolve('Success! (Favorite restaurant)');\r\n                            } else {\r\n                                reject('Failed! (Favorite restaurant)');\r\n                            }\r\n                        })\r\n                        .catch(error => reject(error));\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Favorite a restaurant by its ID.\r\n     * Return Promise to avoid callback functions as parameters.\r\n     */\r\n    static unfavoriteRestaurantById(id) {\r\n        // Search idb for restaurant\r\n        return new Promise((resolve, reject) => {\r\n            DBHelper.getRestaurantFromDbById(id).then(restaurant => {\r\n                if (restaurant) { // Got the restaurant\r\n                    // If restaurant found in idb, update record\r\n                    restaurant.is_favorite = false;\r\n                    DBHelper.addRestaurantToDatabase(restaurant);\r\n                }\r\n\r\n                // Update data in server that restaurant is unfavorited\r\n                fetch(`${DBHelper.DATABASE_URL}/${id}/?is_favorite=false`, {method: 'PUT'})\r\n                        .then(response => {\r\n                            if (response.status == 200) {\r\n                                resolve('Success! (Favorite restaurant)');\r\n                            } else {\r\n                                reject('Failed! (Favorite restaurant)');\r\n                            }\r\n                        })\r\n                        .catch(error => reject(error));\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Search restaurant in db by its id.\r\n     * Return Promise to avoid callback functions as parameters for actions\r\n     * need to be done after restaurant is searched.\r\n     */\r\n    static getRestaurantFromDbById(id) {\r\n        return new Promise((resolve, reject) => {\r\n            DBHelper.DATABASE_PROMISE.then(db => {\r\n                const tx = db.transaction('restaurants');\r\n                return tx.objectStore('restaurants').get(Number(id));\r\n            }).then(restaurant => {\r\n                resolve(restaurant);\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Fetch a restaurant by its ID.\r\n     */\r\n    static fetchRestaurantById(id, callback) {\r\n        // Search restaurant in db by its id.\r\n        DBHelper.getRestaurantFromDbById(id).then(restaurant => {\r\n            if (restaurant) {\r\n                callback(null, restaurant);\r\n            } else {\r\n                // fetch restaurant by id using stage 3 server api GET endpoint.\r\n                fetch(`${DBHelper.DATABASE_URL}/${id}/`)\r\n                        .then(response => response.json())\r\n                        .then(restaurant => {\r\n                            if (restaurant) { // Got the restaurant\r\n                                callback(null, restaurant);\r\n                                DBHelper.addRestaurantToDatabase(restaurant);\r\n                            } else { // Restaurant does not exist in the database\r\n                                callback('Restaurant does not exist', null);\r\n                            }\r\n                        })\r\n                        .catch(error => callback(error, null));\r\n            }\r\n        }, (msg) => console.log(msg));\r\n    }\r\n\r\n    /**\r\n     * Fetch restaurants by a cuisine type with proper error handling.\r\n     */\r\n    static fetchRestaurantByCuisine(cuisine, callback) {\r\n        // Fetch all restaurants  with proper error handling\r\n        DBHelper.fetchRestaurants((error, restaurants) => {\r\n            if (error) {\r\n                callback(error, null);\r\n            } else {\r\n                // Filter restaurants to have only given cuisine type\r\n                const results = restaurants.filter(r => r.cuisine_type == cuisine);\r\n                callback(null, results);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Fetch restaurants by a neighborhood with proper error handling.\r\n     */\r\n    static fetchRestaurantByNeighborhood(neighborhood, callback) {\r\n        // Fetch all restaurants\r\n        DBHelper.fetchRestaurants((error, restaurants) => {\r\n            if (error) {\r\n                callback(error, null);\r\n            } else {\r\n                // Filter restaurants to have only given neighborhood\r\n                const results = restaurants.filter(r => r.neighborhood == neighborhood);\r\n                callback(null, results);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Fetch restaurants by a cuisine and a neighborhood with proper error handling.\r\n     */\r\n    static fetchRestaurantByCuisineAndNeighborhood(cuisine, neighborhood, callback) {\r\n        DBHelper.DATABASE_PROMISE.then(db => {\r\n            const tx = db.transaction('restaurants');\r\n            const restaurantsStore = tx.objectStore('restaurants');\r\n\r\n            return tx.objectStore('restaurants').getAll();\r\n        }).then(restaurants => {\r\n            if (!restaurants.length) {\r\n                addRestaurants = true;\r\n                // Fetch all restaurants\r\n                DBHelper.fetchRestaurants((error, restaurants) => {\r\n                    if (error) {\r\n                        callback(error, null);\r\n                    } else {\r\n                        DBHelper.viewRestaurants(restaurants, cuisine, neighborhood, callback);\r\n                        addRestaurants = false;\r\n                    }\r\n                });\r\n            } else {\r\n                console.log('Restaurants:', restaurants);\r\n                DBHelper.viewRestaurants(restaurants, cuisine, neighborhood, callback);\r\n            }\r\n        }).catch(error => callback(error, null));\r\n    }\r\n\r\n    static viewRestaurants(restaurants, cuisine, neighborhood, callback) {\r\n        let results = restaurants\r\n        if (cuisine != 'all') { // filter by cuisine\r\n            results = results.filter(r => r.cuisine_type == cuisine);\r\n        }\r\n        if (neighborhood != 'all') { // filter by neighborhood\r\n            results = results.filter(r => r.neighborhood == neighborhood);\r\n        }\r\n        callback(null, results);\r\n    }\r\n\r\n    /**\r\n     * Fetch all neighborhoods with proper error handling.\r\n     */\r\n    static fetchNeighborhoods(callback) {\r\n        // Fetch all restaurants\r\n        DBHelper.fetchRestaurants((error, restaurants) => {\r\n            if (error) {\r\n                callback(error, null);\r\n            } else {\r\n                // Get all neighborhoods from all restaurants\r\n                const neighborhoods = restaurants.map((v, i) => restaurants[i].neighborhood)\r\n                // Remove duplicates from neighborhoods\r\n                const uniqueNeighborhoods = neighborhoods.filter((v, i) => neighborhoods.indexOf(v) == i)\r\n                callback(null, uniqueNeighborhoods);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Fetch all cuisines with proper error handling.\r\n     */\r\n    static fetchCuisines(callback) {\r\n        // Fetch all restaurants\r\n        DBHelper.fetchRestaurants((error, restaurants) => {\r\n            if (error) {\r\n                callback(error, null);\r\n            } else {\r\n                // Get all cuisines from all restaurants\r\n                const cuisines = restaurants.map((v, i) => restaurants[i].cuisine_type)\r\n                // Remove duplicates from cuisines\r\n                const uniqueCuisines = cuisines.filter((v, i) => cuisines.indexOf(v) == i)\r\n                callback(null, uniqueCuisines);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Restaurant page URL.\r\n     */\r\n    static urlForRestaurant(restaurant) {\r\n        return (`./restaurant.html?id=${restaurant.id}`);\r\n    }\r\n\r\n    /**\r\n     * Restaurant image URL.\r\n     */\r\n    static imageUrlForRestaurant(restaurant) {\r\n        // Check if restaurant object has a photograph\r\n        if ('photograph' in restaurant) {\r\n            return (`/img/${restaurant.photograph}`);\r\n        } else {\r\n            // If restaurant has not a photograph return 'noimg' so that the\r\n            // rest of the code knows what to do\r\n            return 'noimg';\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Map marker for a restaurant.\r\n     */\r\n    static mapMarkerForRestaurant(restaurant, map) {\r\n        const marker = new google.maps.Marker({\r\n            position: restaurant.latlng,\r\n            title: restaurant.name,\r\n            url: DBHelper.urlForRestaurant(restaurant),\r\n            map: map,\r\n            animation: google.maps.Animation.DROP}\r\n        );\r\n        return marker;\r\n    }\r\n\r\n    /**\r\n     * Add restaurant to database.\r\n     */\r\n    static addRestaurantToDatabase(restaurant) {\r\n        DBHelper.DATABASE_PROMISE.then(function(db) {\r\n            var tx = db.transaction('restaurants', 'readwrite');\r\n            var restaurantsStore = tx.objectStore('restaurants');\r\n            restaurantsStore.put(restaurant);\r\n\r\n            return tx.complete;\r\n        }).then(function() {\r\n            console.log('Restaurant added');\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Fetch all review by restaurant id.\r\n     */\r\n    static fetchReviewsByRestaurantId(restaurant_id) {\r\n        return new Promise((resolve, reject) => {\r\n            // Check if restaurant's reviews exist in db\r\n            DBHelper.DATABASE_PROMISE.then(db => {\r\n                const tx = db.transaction('reviews');\r\n                const reviewsStore = tx.objectStore('reviews');\r\n                const restaurantIdIndex = reviewsStore.index('restaurant_id');\r\n                return restaurantIdIndex.getAll(restaurant_id);\r\n            }).then(reviews => {\r\n                if (!reviews.length) {\r\n                    // If not found in db, fetch them fro server\r\n                    fetch(`${DBHelper.DATABASE_URL_REVIEWS}/?restaurant_id=${restaurant_id}`)\r\n                            .then(response => response.json())\r\n                            // Resolve reviews with a boolean flag that indicates to add reviews to db\r\n                            .then(reviews => resolve([reviews, true]))\r\n                            .catch(error => reject(error));\r\n                } else {\r\n                    // If found in db, resolve reviews with a boolean flag that indicates to not add reviews to db\r\n                    resolve([reviews, false]);\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Add review to database.\r\n     */\r\n    static addReviewToDatabase(review) {\r\n        DBHelper.DATABASE_PROMISE.then(function(db) {\r\n            const tx = db.transaction('reviews', 'readwrite');\r\n            const reviewsStore = tx.objectStore('reviews');\r\n            reviewsStore.put(review);\r\n\r\n            return tx.complete;\r\n        }).then(() => {\r\n            console.log('Review added');\r\n        });\r\n    }\r\n}\r\n\r\nconst DATABASE_PROMISE = DBHelper.openDatabase();\r\nlet addRestaurants = false;\r\n\r\nexport default DBHelper;","/**\r\n * helper.js contains functions that help not repeat code\r\n * in order to keep the code in other js files tidied up\r\n */\r\n\r\n/**\r\n * Create source element and append it to picture element.\r\n */\r\nexport const addImageSourceToPicture = (picture, srcset, media) => {\r\n    const source = document.createElement('source');\r\n    if (media !== undefined) {\r\n        source.media = media;\r\n    }\r\n    source.setAttribute('data-srcset', srcset);\r\n    picture.append(source);\r\n};\r\n\r\n/**\r\n * Extract extension from filename.\r\n */\r\nexport const fileExtension = (filename) => {\r\n    return filename.split('.').pop();\r\n};\r\n\r\n/**\r\n * Get filename without extension.\r\n */\r\nexport const filenameWithoutExtension = (filename) => {\r\n    return filename.replace(/.[^.]+$/, '');\r\n};\r\n\r\n/**\r\n * Get all possible names of an image depending on its size (small, medium, large).\r\n */\r\nexport const imageNamesBySize = (imageFilename) => {\r\n    const imageExtension = 'jpg';\r\n    const filenames = {};\r\n    filenames.small = `${imageFilename}-small.${imageExtension}`;\r\n    filenames.medium = `${imageFilename}-medium.${imageExtension}`;\r\n    filenames.large = `${imageFilename}-large.${imageExtension}`;\r\n\r\n    return filenames;\r\n};\r\n\r\n/**\r\n * Include google maps api on the fly.\r\n * Google map is lazy loaded using the IntersectionObserver API.\r\n * The code for this function is from the \r\n * Lazy loading Google Maps with the IntersectionObserver API article:\r\n * https://walterebert.com/blog/lazy-loading-google-maps-with-the-intersection-observer-api/\r\n * The only thing changed is that muicss loadJS is used instead of \r\n * Filament Group loadJS used in the original, to load js scripts on the fly.\r\n * Check for offline state to not load google maps script is added.\r\n */\r\nexport const getGoogleMapsApi = () => {\r\n    'use strict';\r\n\r\n    const options = {\r\n        rootMargin: '400px',\r\n        threshold: 0\r\n    };\r\n\r\n    const map = document.getElementById('map');\r\n\r\n    // Lazy loading Google Maps with the IntersectionObserver API\r\n    const observer = new IntersectionObserver(\r\n            (entries, observer) => {\r\n        // Detect intersection https://calendar.perfplanet.com/2017/progressive-image-loading-using-intersection-observer-and-sqip/#comment-102838\r\n        const isIntersecting = typeof entries[0].isIntersecting === 'boolean' ? entries[0].isIntersecting : entries[0].intersectionRatio > 0;\r\n        if (isIntersecting) {\r\n            // Check if page is offline\r\n            if ((` ${map.className} `).replace(/[\\n\\t]/g, ' ').indexOf(' offline ') > -1) {\r\n                // If page is offline, show corresponding message on map\r\n                if (!document.getElementById('map-offline')) {\r\n                    // Display a map load failure message\r\n                    const mapOffline = document.createElement('div');\r\n                    mapOffline.id = 'map-offline';\r\n\r\n                    const mapOfflineMessage = document.createElement('span');\r\n                    mapOfflineMessage.innerHTML = 'No internet connection. Failed to load map.';\r\n                    mapOfflineMessage.id = 'map-offline-message';\r\n                    mapOffline.appendChild(mapOfflineMessage);\r\n\r\n                    map.append(mapOffline);\r\n                }\r\n            } else {\r\n                // Load google maps\r\n                // Scripts are loaded using muicss loadJS: https://github.com/muicss/loadjs\r\n                loadjs(['https://maps.googleapis.com/maps/api/js?key=AIzaSyBzXDGrWxj1GsJUbo9ZKSJPz07o2K1ljgc&libraries=places&callback=initMap']);\r\n                observer.unobserve(map);\r\n            }\r\n        }\r\n    }, options);\r\n\r\n    observer.observe(map);\r\n};\r\n\r\n/**\r\n * Include LazyLoad plugin: https://www.andreaverlicchi.eu/lazyload/#recipes\r\n */\r\nexport const getLazyLoadPlugin = () => {\r\n    // Conditionally load the best version of LazyLoad depending on the browser's support of the IntersectionObserver API. \r\n    (function(w, d) {\r\n        var b = d.getElementsByTagName('body')[0];\r\n        var s = d.createElement(\"script\");\r\n        s.async = true;\r\n        var v = !(\"IntersectionObserver\" in w) ? \"8.7.1\" : \"10.5.2\";\r\n        s.src = \"https://cdnjs.cloudflare.com/ajax/libs/vanilla-lazyload/\" + v + \"/lazyload.min.js\";\r\n        w.lazyLoadOptions = {\r\n            elements_selector: '.lazy'\r\n        }; // Your options here. See \"recipes\" for more information about async.\r\n        b.appendChild(s);\r\n    }(window, document));\r\n};\r\n\r\n/**\r\n * Convert unix timestamp to date string.\r\n */\r\nexport const timestampToDate = timestamp => {\r\n    const date = new Date(timestamp);\r\n\r\n    const day = date.getDate();\r\n    const month = getMonthName(date.getMonth());\r\n    const year = date.getFullYear();\r\n    \r\n    return `${month} ${day}, ${year}`;\r\n};\r\n\r\n/**\r\n * Return month's name depending on its number.\r\n * Code is from https://www.w3schools.com/jsref/jsref_getmonth.asp\r\n */\r\nconst getMonthName = (monthIndex) => {\r\n    const month = new Array();\r\n    month[0] = 'January';\r\n    month[1] = 'February';\r\n    month[2] = 'March';\r\n    month[3] = 'April';\r\n    month[4] = 'May';\r\n    month[5] = 'June';\r\n    month[6] = 'July';\r\n    month[7] = 'August';\r\n    month[8] = 'September';\r\n    month[9] = 'October';\r\n    month[10] = 'November';\r\n    month[11] = 'December';\r\n\r\n    return month[monthIndex];\r\n};","\n/**\n * When source maps are enabled, `style-loader` uses a link element with a data-uri to\n * embed the css on the page. This breaks all relative urls because now they are relative to a\n * bundle instead of the current page.\n *\n * One solution is to only use full urls, but that may be impossible.\n *\n * Instead, this function \"fixes\" the relative urls to be absolute according to the current page location.\n *\n * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.\n *\n */\n\nmodule.exports = function (css) {\n  // get current location\n  var location = typeof window !== \"undefined\" && window.location;\n\n  if (!location) {\n    throw new Error(\"fixUrls requires window.location\");\n  }\n\n\t// blank or null?\n\tif (!css || typeof css !== \"string\") {\n\t  return css;\n  }\n\n  var baseUrl = location.protocol + \"//\" + location.host;\n  var currentDir = baseUrl + location.pathname.replace(/\\/[^\\/]*$/, \"/\");\n\n\t// convert each url(...)\n\t/*\n\tThis regular expression is just a way to recursively match brackets within\n\ta string.\n\n\t /url\\s*\\(  = Match on the word \"url\" with any whitespace after it and then a parens\n\t   (  = Start a capturing group\n\t     (?:  = Start a non-capturing group\n\t         [^)(]  = Match anything that isn't a parentheses\n\t         |  = OR\n\t         \\(  = Match a start parentheses\n\t             (?:  = Start another non-capturing groups\n\t                 [^)(]+  = Match anything that isn't a parentheses\n\t                 |  = OR\n\t                 \\(  = Match a start parentheses\n\t                     [^)(]*  = Match anything that isn't a parentheses\n\t                 \\)  = Match a end parentheses\n\t             )  = End Group\n              *\\) = Match anything and then a close parens\n          )  = Close non-capturing group\n          *  = Match anything\n       )  = Close capturing group\n\t \\)  = Match a close parens\n\n\t /gi  = Get all matches, not the first.  Be case insensitive.\n\t */\n\tvar fixedCss = css.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi, function(fullMatch, origUrl) {\n\t\t// strip quotes (if they exist)\n\t\tvar unquotedOrigUrl = origUrl\n\t\t\t.trim()\n\t\t\t.replace(/^\"(.*)\"$/, function(o, $1){ return $1; })\n\t\t\t.replace(/^'(.*)'$/, function(o, $1){ return $1; });\n\n\t\t// already a full url? no change\n\t\tif (/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/|\\s*$)/i.test(unquotedOrigUrl)) {\n\t\t  return fullMatch;\n\t\t}\n\n\t\t// convert the url to a full url\n\t\tvar newUrl;\n\n\t\tif (unquotedOrigUrl.indexOf(\"//\") === 0) {\n\t\t  \t//TODO: should we add protocol?\n\t\t\tnewUrl = unquotedOrigUrl;\n\t\t} else if (unquotedOrigUrl.indexOf(\"/\") === 0) {\n\t\t\t// path should be relative to the base url\n\t\t\tnewUrl = baseUrl + unquotedOrigUrl; // already starts with '/'\n\t\t} else {\n\t\t\t// path should be relative to current directory\n\t\t\tnewUrl = currentDir + unquotedOrigUrl.replace(/^\\.\\//, \"\"); // Strip leading './'\n\t\t}\n\n\t\t// send back the fixed url(...)\n\t\treturn \"url(\" + JSON.stringify(newUrl) + \")\";\n\t});\n\n\t// send back the fixed css\n\treturn fixedCss;\n};\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\nvar stylesInDom = {};\n\nvar\tmemoize = function (fn) {\n\tvar memo;\n\n\treturn function () {\n\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\treturn memo;\n\t};\n};\n\nvar isOldIE = memoize(function () {\n\t// Test for IE <= 9 as proposed by Browserhacks\n\t// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n\t// Tests for existence of standard globals is to allow style-loader\n\t// to operate correctly into non-standard environments\n\t// @see https://github.com/webpack-contrib/style-loader/issues/177\n\treturn window && document && document.all && !window.atob;\n});\n\nvar getTarget = function (target) {\n  return document.querySelector(target);\n};\n\nvar getElement = (function (fn) {\n\tvar memo = {};\n\n\treturn function(target) {\n                // If passing function in options, then use it for resolve \"head\" element.\n                // Useful for Shadow Root style i.e\n                // {\n                //   insertInto: function () { return document.querySelector(\"#foo\").shadowRoot }\n                // }\n                if (typeof target === 'function') {\n                        return target();\n                }\n                if (typeof memo[target] === \"undefined\") {\n\t\t\tvar styleTarget = getTarget.call(this, target);\n\t\t\t// Special case to return head of iframe instead of iframe itself\n\t\t\tif (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n\t\t\t\ttry {\n\t\t\t\t\t// This will throw an exception if access to iframe is blocked\n\t\t\t\t\t// due to cross-origin restrictions\n\t\t\t\t\tstyleTarget = styleTarget.contentDocument.head;\n\t\t\t\t} catch(e) {\n\t\t\t\t\tstyleTarget = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\tmemo[target] = styleTarget;\n\t\t}\n\t\treturn memo[target]\n\t};\n})();\n\nvar singleton = null;\nvar\tsingletonCounter = 0;\nvar\tstylesInsertedAtTop = [];\n\nvar\tfixUrls = require(\"./urls\");\n\nmodule.exports = function(list, options) {\n\tif (typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif (typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\n\toptions.attrs = typeof options.attrs === \"object\" ? options.attrs : {};\n\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (!options.singleton && typeof options.singleton !== \"boolean\") options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the <head> element\n        if (!options.insertInto) options.insertInto = \"head\";\n\n\t// By default, add <style> tags to the bottom of the target\n\tif (!options.insertAt) options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list, options);\n\n\taddStylesToDom(styles, options);\n\n\treturn function update (newList) {\n\t\tvar mayRemove = [];\n\n\t\tfor (var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList, options);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\n\t\tfor (var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor (var j = 0; j < domStyle.parts.length; j++) domStyle.parts[j]();\n\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n};\n\nfunction addStylesToDom (styles, options) {\n\tfor (var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles (list, options) {\n\tvar styles = [];\n\tvar newStyles = {};\n\n\tfor (var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = options.base ? item[0] + options.base : item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\n\t\tif(!newStyles[id]) styles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse newStyles[id].parts.push(part);\n\t}\n\n\treturn styles;\n}\n\nfunction insertStyleElement (options, style) {\n\tvar target = getElement(options.insertInto)\n\n\tif (!target) {\n\t\tthrow new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");\n\t}\n\n\tvar lastStyleElementInsertedAtTop = stylesInsertedAtTop[stylesInsertedAtTop.length - 1];\n\n\tif (options.insertAt === \"top\") {\n\t\tif (!lastStyleElementInsertedAtTop) {\n\t\t\ttarget.insertBefore(style, target.firstChild);\n\t\t} else if (lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\ttarget.insertBefore(style, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\ttarget.appendChild(style);\n\t\t}\n\t\tstylesInsertedAtTop.push(style);\n\t} else if (options.insertAt === \"bottom\") {\n\t\ttarget.appendChild(style);\n\t} else if (typeof options.insertAt === \"object\" && options.insertAt.before) {\n\t\tvar nextSibling = getElement(options.insertInto + \" \" + options.insertAt.before);\n\t\ttarget.insertBefore(style, nextSibling);\n\t} else {\n\t\tthrow new Error(\"[Style Loader]\\n\\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\\n Must be 'top', 'bottom', or Object.\\n (https://github.com/webpack-contrib/style-loader#insertat)\\n\");\n\t}\n}\n\nfunction removeStyleElement (style) {\n\tif (style.parentNode === null) return false;\n\tstyle.parentNode.removeChild(style);\n\n\tvar idx = stylesInsertedAtTop.indexOf(style);\n\tif(idx >= 0) {\n\t\tstylesInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement (options) {\n\tvar style = document.createElement(\"style\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\n\taddAttrs(style, options.attrs);\n\tinsertStyleElement(options, style);\n\n\treturn style;\n}\n\nfunction createLinkElement (options) {\n\tvar link = document.createElement(\"link\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\toptions.attrs.rel = \"stylesheet\";\n\n\taddAttrs(link, options.attrs);\n\tinsertStyleElement(options, link);\n\n\treturn link;\n}\n\nfunction addAttrs (el, attrs) {\n\tObject.keys(attrs).forEach(function (key) {\n\t\tel.setAttribute(key, attrs[key]);\n\t});\n}\n\nfunction addStyle (obj, options) {\n\tvar style, update, remove, result;\n\n\t// If a transform function was defined, run it on the css\n\tif (options.transform && obj.css) {\n\t    result = options.transform(obj.css);\n\n\t    if (result) {\n\t    \t// If transform returns a value, use that instead of the original css.\n\t    \t// This allows running runtime transformations on the css.\n\t    \tobj.css = result;\n\t    } else {\n\t    \t// If the transform function returns a falsy value, don't add this css.\n\t    \t// This allows conditional loading of css\n\t    \treturn function() {\n\t    \t\t// noop\n\t    \t};\n\t    }\n\t}\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\n\t\tstyle = singleton || (singleton = createStyleElement(options));\n\n\t\tupdate = applyToSingletonTag.bind(null, style, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, style, styleIndex, true);\n\n\t} else if (\n\t\tobj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\"\n\t) {\n\t\tstyle = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, style, options);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\n\t\t\tif(style.href) URL.revokeObjectURL(style.href);\n\t\t};\n\t} else {\n\t\tstyle = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, style);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle (newObj) {\n\t\tif (newObj) {\n\t\t\tif (\n\t\t\t\tnewObj.css === obj.css &&\n\t\t\t\tnewObj.media === obj.media &&\n\t\t\t\tnewObj.sourceMap === obj.sourceMap\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag (style, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (style.styleSheet) {\n\t\tstyle.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = style.childNodes;\n\n\t\tif (childNodes[index]) style.removeChild(childNodes[index]);\n\n\t\tif (childNodes.length) {\n\t\t\tstyle.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyle.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag (style, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyle.setAttribute(\"media\", media)\n\t}\n\n\tif(style.styleSheet) {\n\t\tstyle.styleSheet.cssText = css;\n\t} else {\n\t\twhile(style.firstChild) {\n\t\t\tstyle.removeChild(style.firstChild);\n\t\t}\n\n\t\tstyle.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink (link, options, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\t/*\n\t\tIf convertToAbsoluteUrls isn't defined, but sourcemaps are enabled\n\t\tand there is no publicPath defined then lets turn convertToAbsoluteUrls\n\t\ton by default.  Otherwise default to the convertToAbsoluteUrls option\n\t\tdirectly\n\t*/\n\tvar autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;\n\n\tif (options.convertToAbsoluteUrls || autoFixUrls) {\n\t\tcss = fixUrls(css);\n\t}\n\n\tif (sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = link.href;\n\n\tlink.href = URL.createObjectURL(blob);\n\n\tif(oldSrc) URL.revokeObjectURL(oldSrc);\n}\n","\nvar content = require(\"!!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js!./styles.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js!./styles.css\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/mini-css-extract-plugin/dist/loader.js!../../node_modules/css-loader/index.js!./styles.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","import './../css/styles.css';\r\nimport {addImageSourceToPicture, imageNamesBySize, getGoogleMapsApi, getLazyLoadPlugin, timestampToDate} from './helper.js';\r\nimport DBHelper from './dbhelper.js';\r\n\r\nlet restaurant;\r\nvar map;\r\n\r\ndocument.addEventListener('DOMContentLoaded', (event) => {\r\n    fetchRestaurantFromURL(error => {\r\n        if (error) { // Got an error!\r\n            console.error(error);\r\n        } else {\r\n            fillRestaurantHTML();\r\n            fillBreadcrumb();\r\n\r\n            // Include LazyLoad plugin\r\n            getLazyLoadPlugin();\r\n\r\n            // Include maps api dynamically only after everything else has been done\r\n            getGoogleMapsApi();\r\n        }\r\n    });\r\n});\r\n\r\n// Toggle 'mark as favorite' toggle and add the appropriate styles and aria-label\r\n// depending on whether restaurant is favorite or not\r\ndocument.getElementById('restaurant-isfavorite').addEventListener('click', (event) => {\r\n    const isfavoriteButton = document.getElementById('restaurant-isfavorite');\r\n    const isfavoriteIcon = document.getElementById('restaurant-isfavorite-icon');\r\n    const id = getParameterByName('id');\r\n    if (!isfavoriteButton.classList.contains('selected')) {\r\n        // Favorite restaurant and update server and idb\r\n        DBHelper.favoriteRestaurantById(id)\r\n                .then(() => {\r\n                    isfavoriteIcon.classList.add('fas');\r\n                    isfavoriteIcon.classList.remove('far');\r\n                    isfavoriteButton.classList.add('selected');\r\n                    isfavoriteButton.setAttribute('aria-label', 'Unfavorite restaurant');\r\n                }, (msg) => console.log(msg));\r\n    } else {\r\n        // Unavorite restaurant and update server and idb\r\n        DBHelper.unfavoriteRestaurantById(id)\r\n                .then(() => {\r\n                    isfavoriteIcon.classList.add('far');\r\n                    isfavoriteIcon.classList.remove('fas');\r\n                    isfavoriteButton.classList.remove('selected');\r\n                    isfavoriteButton.setAttribute('aria-label', 'Favorite restaurant');\r\n                }, (msg) => console.log(msg));\r\n    }\r\n});\r\n\r\nconst addReviewForm = document.getElementById('add-review-form');\r\naddReviewForm.addEventListener('submit', event => {\r\n    event.preventDefault();\r\n\r\n    const loadingImg = document.getElementById('add-review-submit-loading');\r\n    loadingImg.style.display = 'inline';\r\n    const reviewSubmit = document.getElementById('review-submit');\r\n    reviewSubmit.disabled = true;\r\n\r\n    // Reset messages and error classes\r\n    const messageSuccess = document.getElementById('add-review-submit-success');\r\n    messageSuccess.style.display = 'none';\r\n    const messageError = document.getElementById('add-review-submit-error');\r\n    messageError.style.display = 'none';\r\n    const messageErrorEmpty = document.getElementById('add-review-submit-error-empty');\r\n    messageErrorEmpty.style.display = 'none';\r\n    const addRreviewName = document.getElementById('add-review-name');\r\n    addRreviewName.classList.remove('add-review-submit-message-field-error');\r\n    addRreviewName.setAttribute('aria-invalid', 'false');\r\n    const addRreviewRating = document.getElementById('add-review-rating');\r\n    addRreviewRating.classList.remove('add-review-submit-message-field-error');\r\n    addRreviewRating.setAttribute('aria-invalid', 'false');\r\n    const addRreviewComments = document.getElementById('add-review-comments');\r\n    addRreviewComments.classList.remove('add-review-submit-message-field-error');\r\n    addRreviewComments.setAttribute('aria-invalid', 'false');\r\n\r\n    const review = {};\r\n    review.restaurant_id = parseInt(document.getElementById('add-review-restaurant-id').value);\r\n    review.name = addRreviewName.value;\r\n    review.rating = parseInt(addRreviewRating.value);\r\n    review.comments = addRreviewComments.value;\r\n    review.createdAt = Date.now();\r\n\r\n    // Validate inputs\r\n    let valid_data = true;\r\n    if (!(review.restaurant_id > 0)) {\r\n        valid_data = false;\r\n        loadingImg.style.display = 'none';\r\n        reviewSubmit.disabled = false;\r\n        messageError.style.display = 'inline';\r\n        console.log('Invalid restaurant_id');\r\n    }\r\n\r\n    if (valid_data) {\r\n        let empty_data = false;\r\n        if (review.name == '') {\r\n            addRreviewName.classList.add('add-review-submit-message-field-error');\r\n            addRreviewName.setAttribute('aria-invalid', 'true');\r\n            valid_data = false;\r\n            empty_data = true;\r\n        }\r\n        if (!(review.rating >= 1 || review.rating <= 5)) {\r\n            addRreviewRating.classList.add('add-review-submit-message-field-error');\r\n            addRreviewRating.setAttribute('aria-invalid', 'true');\r\n            valid_data = false;\r\n            empty_data = true;\r\n        }\r\n        if (review.comments == '') {\r\n            addRreviewComments.classList.add('add-review-submit-message-field-error');\r\n            addRreviewComments.setAttribute('aria-invalid', 'true');\r\n            valid_data = false;\r\n            empty_data = true;\r\n        }\r\n\r\n        if (!empty_data) {\r\n            // Add review to db\r\n            DBHelper.addReviewToDatabase(review);\r\n\r\n            // Append review to html\r\n            const ul = document.getElementById('reviews-list');\r\n            ul.prepend(createReviewHTML(review));\r\n            loadingImg.style.display = 'none';\r\n            reviewSubmit.disabled = false;\r\n            messageSuccess.style.display = 'inline';\r\n            addReviewForm.reset();\r\n        } else {\r\n            loadingImg.style.display = 'none';\r\n            reviewSubmit.disabled = false;\r\n            messageErrorEmpty.style.display = 'inline';\r\n        }\r\n    }\r\n});\r\n\r\n/**\r\n * Initialize Google map, called from HTML.\r\n */\r\nwindow.initMap = () => {\r\n    self.map = new google.maps.Map(document.getElementById('map'), {\r\n        zoom: 16,\r\n        center: self.restaurant.latlng,\r\n        scrollwheel: false\r\n    });\r\n\r\n    // Add markers to the map after being initialized\r\n    DBHelper.mapMarkerForRestaurant(self.restaurant, self.map);\r\n}\r\n\r\n/**\r\n * Get current restaurant from page URL.\r\n */\r\nconst fetchRestaurantFromURL = (callback) => {\r\n    if (self.restaurant) { // restaurant already fetched!\r\n        callback(null);\r\n        return;\r\n    }\r\n    const id = getParameterByName('id');\r\n    if (!id) { // no id found in URL\r\n        error = 'No restaurant id in URL'\r\n        callback(error);\r\n    } else {\r\n        DBHelper.fetchRestaurantById(id, (error, restaurant) => {\r\n            self.restaurant = restaurant;\r\n            if (!restaurant) {\r\n                console.error(error);\r\n                return;\r\n            }\r\n\r\n            callback(null);\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * Create restaurant HTML and add it to the webpage\r\n */\r\nconst fillRestaurantHTML = (restaurant = self.restaurant) => {\r\n    const name = document.getElementById('restaurant-name');\r\n    name.innerHTML = restaurant.name;\r\n\r\n    const address = document.getElementById('restaurant-address');\r\n    address.innerHTML = restaurant.address;\r\n\r\n    const image = document.getElementById('restaurant-img');\r\n    image.className = 'restaurant-img lazy';\r\n    image.alt = restaurant.name;\r\n\r\n    const imageFilename = DBHelper.imageUrlForRestaurant(restaurant);\r\n    if (imageFilename == 'noimg') {\r\n        const restaurantImgSourcesPicture = document.getElementById('restaurant-img-sources');\r\n        // Remove sources and image from picture to add the noimg sources\r\n        while (restaurantImgSourcesPicture.firstChild) {\r\n            restaurantImgSourcesPicture.removeChild(restaurantImgSourcesPicture.firstChild);\r\n        }\r\n\r\n// If restaurant has not an image, display a no image svg\r\n// and use its corresponding png as a fallback.\r\n// Author of the noimg.svg and noimg.png is credited at page's footer.\r\n        const noImgFallback = `${imageFilename}.png`;\r\n        addImageSourceToPicture(restaurantImgSourcesPicture, `${imageFilename}.svg`);\r\n        addImageSourceToPicture(restaurantImgSourcesPicture, noImgFallback);\r\n\r\n        image.setAttribute('data-src', noImgFallback);\r\n        image.className += ' noimg';\r\n\r\n        restaurantImgSourcesPicture.append(image);\r\n        // TODO: Fix noimg png fallback in IE\r\n    } else {\r\n// get all possible names of an image depending on its size (small, medium, large)\r\n        const imagesResized = imageNamesBySize(imageFilename);\r\n\r\n        // assign srcset attribute for medium picture source (medium screens)\r\n        const restaurantImgMedium = document.getElementById('restaurant-img-medium');\r\n        restaurantImgMedium.setAttribute('data-srcset', imagesResized.medium);\r\n\r\n        // assign srcset attribute for large picture source (medium screens)\r\n        const restaurantImgMediumLarge = document.getElementById('restaurant-img-medium-large');\r\n        restaurantImgMediumLarge.setAttribute('data-srcset', imagesResized.large);\r\n\r\n        // assign srcset attribute for large picture source (large screens)\r\n        const restaurantImgLarge = document.getElementById('restaurant-img-large');\r\n        restaurantImgLarge.setAttribute('data-srcset', `${imagesResized.medium} 1x, ${imagesResized.large} 2x`);\r\n\r\n        image.setAttribute('data-src', imagesResized.small); // small image by default\r\n    }\r\n\r\n    const cuisine = document.getElementById('restaurant-cuisine');\r\n    cuisine.innerHTML = restaurant.cuisine_type;\r\n    cuisine.setAttribute('aria-label', `Restaurant cuisine type ${restaurant.cuisine_type}`);\r\n\r\n    // Stylize 'mark as favorite' toggle depending on whether restaurant is favorite or not\r\n    // and add the appropriate aria-label\r\n    const isfavoriteButton = document.getElementById('restaurant-isfavorite');\r\n    if (restaurant.is_favorite) {\r\n        const isfavoriteIcon = document.getElementById('restaurant-isfavorite-icon');\r\n        isfavoriteButton.classList.add('selected');\r\n        isfavoriteButton.setAttribute('aria-label', 'Unfavorite restaurant');\r\n        isfavoriteIcon.classList.remove('far');\r\n        isfavoriteIcon.classList.add('fas');\r\n    } else {\r\n        isfavoriteButton.setAttribute('aria-label', 'Favorite restaurant');\r\n    }\r\n\r\n    // fill operating hours\r\n    if (restaurant.operating_hours) {\r\n        fillRestaurantHoursHTML();\r\n    }\r\n\r\n// Add restaurant id value to add a review hidden input\r\n    const addReviewRestaurantId = document.getElementById('add-review-restaurant-id');\r\n    addReviewRestaurantId.value = restaurant.id;\r\n\r\n// fill reviews\r\n    fillReviewsHTML();\r\n}\r\n\r\n/**\r\n * Create restaurant operating hours HTML table and add it to the webpage.\r\n */\r\nconst fillRestaurantHoursHTML = (operatingHours = self.restaurant.operating_hours) => {\r\n    const hours = document.getElementById('restaurant-hours');\r\n    for (let key in operatingHours) {\r\n        const row = document.createElement('tr');\r\n\r\n        const day = document.createElement('td');\r\n        day.innerHTML = key;\r\n        row.appendChild(day);\r\n\r\n        const time = document.createElement('td');\r\n        time.innerHTML = operatingHours[key];\r\n        row.appendChild(time);\r\n\r\n        hours.appendChild(row);\r\n}\r\n}\r\n\r\n/**\r\n * Create all reviews HTML and add them to the webpage.\r\n */\r\nconst fillReviewsHTML = (restaurantId = self.restaurant.id) => {\r\n    const container = document.getElementById('reviews-container');\r\n    container.setAttribute('aria-labelledby', 'reviews-heading');\r\n\r\n    const title = document.createElement('h3');\r\n    title.innerHTML = 'Reviews';\r\n    title.id = 'reviews-heading';\r\n    container.appendChild(title);\r\n\r\n    // Get restaurant's reviews\r\n    DBHelper.fetchReviewsByRestaurantId(restaurantId).then(reviews_data => {\r\n        // Restaurant's reviews\r\n        const reviews = reviews_data[0];\r\n        // addToDb is a boolean flag that indicates to add or not reviews to db\r\n        const addToDb = reviews_data[1];\r\n        if (!reviews.length) {\r\n            const noReviews = document.createElement('p');\r\n            noReviews.innerHTML = 'No reviews yet!';\r\n            container.appendChild(noReviews);\r\n            return;\r\n        }\r\n        const ul = document.getElementById('reviews-list');\r\n        reviews.forEach(review => {\r\n            if (addToDb) {\r\n                // Add review to db\r\n                DBHelper.addReviewToDatabase(review);\r\n            }\r\n            ul.appendChild(createReviewHTML(review));\r\n        });\r\n        container.appendChild(ul);\r\n    });\r\n};\r\n\r\n/**\r\n * Create review HTML and add it to the webpage.\r\n */\r\nconst createReviewHTML = (review) => {\r\n    const li = document.createElement('li');\r\n    const name = document.createElement('p');\r\n    name.innerHTML = review.name;\r\n    li.appendChild(name);\r\n\r\n    // Convert review's property createdAt (timestamp) to date string.\r\n    const dateString = timestampToDate(review.createdAt);\r\n\r\n    const date = document.createElement('p');\r\n    date.innerHTML = dateString;\r\n    li.appendChild(date);\r\n\r\n    const rating = document.createElement('p');\r\n    rating.innerHTML = `Rating: ${review.rating}`;\r\n    li.appendChild(rating);\r\n\r\n    const comments = document.createElement('p');\r\n    comments.innerHTML = review.comments;\r\n    li.appendChild(comments);\r\n\r\n    li.tabIndex = 0;\r\n\r\n    return li;\r\n}\r\n\r\n/**\r\n * Add restaurant name to the breadcrumb navigation menu\r\n */\r\nconst fillBreadcrumb = (restaurant = self.restaurant) => {\r\n    const breadcrumb = document.getElementById('breadcrumb');\r\n\r\n    const li = document.createElement('li');\r\n    breadcrumb.appendChild(li);\r\n\r\n    const a = document.createElement('a');\r\n    a.href = '#';\r\n    a.innerHTML = restaurant.name;\r\n    a.setAttribute('aria-current', 'page');\r\n    li.appendChild(a);\r\n}\r\n\r\n/**\r\n * Get a parameter by name from page URL.\r\n */\r\nconst getParameterByName = (name, url) => {\r\n    if (!url)\r\n        url = window.location.href;\r\n    name = name.replace(/[\\[\\]]/g, '\\\\$&');\r\n    const regex = new RegExp(`[?&]${name}(=([^&#]*)|&|#|$)`),\r\n            results = regex.exec(url);\r\n    if (!results)\r\n        return null;\r\n    if (!results[2])\r\n        return '';\r\n    return decodeURIComponent(results[2].replace(/\\+/g, ' '));\r\n}\r\n"],"sourceRoot":""}